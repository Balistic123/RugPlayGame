import{g as Lt,f as $,a,b as Dt,t as u,s as pe,c as h}from"../chunks/BiLdCT7w.js";import{o as Et}from"../chunks/DBnYf9wq.js";import{p as Qt,b as E,f as _e,h as jt,i as l,a as Mt,s,c as P,e as c,g as e,d as y,r as x,n as d,t as $e}from"../chunks/Dc9Cd6uL.js";import{i as ge}from"../chunks/4JrI1xkN.js";import{e as ke,i as Qe}from"../chunks/DT6MbhOo.js";import{c as o}from"../chunks/DKQvO5e2.js";import{C as Yt}from"../chunks/BE8a_9Ge.js";import{C as Vt}from"../chunks/D0g6TdLa.js";import{C as qt}from"../chunks/CTo_Vl_F.js";import{d as Ht,f as Kt,e as Gt,h as Jt,i as Wt}from"../chunks/aor5dgAF.js";import{C as Xt}from"../chunks/b_f0gCBc.js";import{C as Zt}from"../chunks/jS9pjJ83.js";import{P as er,S as tr,a as rr,R as ar,b as sr,c as we,d as or,e as nr,f as lr,g as ir,h as cr}from"../chunks/QqaU5kKh.js";import{R as nt,S as lt,a as it,b as ct,c as dt}from"../chunks/BZ8NTllV.js";import{I as dr}from"../chunks/5J9eaWb4.js";import{B as X}from"../chunks/PVG7Em25.js";import{B as ur}from"../chunks/BvtTpaCk.js";import{L as je}from"../chunks/Ct87CVwI.js";import{D as vr}from"../chunks/E71pIGAW.js";import{S as mr}from"../chunks/BGGxhLCO.js";import{t as ut}from"../chunks/BR_bh9L_.js";import{M as fr}from"../chunks/D50NRik3.js";import{g as Me}from"../chunks/BnkorlfL.js";import{p as pr}from"../chunks/8ie5RpLH.js";import{S as _r,R as $r}from"../chunks/DyH1ohg8.js";import{R as vt}from"../chunks/B8Any_pz.js";import{C as gr}from"../chunks/BdYe1mLp.js";import{C as hr}from"../chunks/DrySvPfe.js";var yr=$("<!> Filters <!>",1),xr=$("<!> <!>",1),Pr=$("<!> <!>",1),br=$('<div class="space-y-4"><div class="space-y-2"><!> <div class="grid grid-cols-2 gap-2"><!> <!> <!> <!></div></div> <div class="space-y-2"><!> <!></div> <div class="space-y-2"><!> <!></div> <div class="flex gap-2 pt-2"><!> <!></div></div>'),Sr=$("<!> <!>",1),Cr=$('<div class="mb-4 flex items-center justify-between"><div class="text-muted-foreground text-sm"> </div> <!></div>'),kr=$("<!> History",1),wr=$("<!> <!>",1),Tr=$('<div class="bg-muted h-16 animate-pulse rounded-lg"></div>'),Rr=$('<div class="space-y-4"></div>'),Br=$("<!> <!>",1),Fr=$('<!> <span class="hidden sm:block">Previous</span>',1),Ar=$('<span class="hidden sm:block">Next</span> <!>',1),Or=$("<!> <!> <!>",1),Ur=$('<div class="mt-8 flex justify-center"><!></div>'),zr=$('<!> <div class="container mx-auto max-w-7xl p-6"><header class="mb-8"><div class="text-center"><h1 class="mb-2 text-3xl font-bold">Transactions</h1> <p class="text-muted-foreground mb-6">Complete record of your trading activity and transactions</p> <div class="mx-auto flex max-w-2xl items-center justify-center gap-2"><div class="relative flex-1"><!> <!></div> <!> <!></div></div></header> <!> <!> <!></div>',1);function da(mt,ft){Qt(ft,!0);const[pt,_t]=Dt(),le=()=>Lt(pr,"$page",pt);let Ye=E(_e([])),ie=E(0),ce=E(!0),Q=E(_e(le().url.searchParams.get("search")||"")),Z=E(_e(le().url.searchParams.get("type")||"all")),R=E(_e(le().url.searchParams.get("sortBy")||"timestamp")),B=E(_e(le().url.searchParams.get("sortOrder")||"desc")),Se=E(!1),b=E(_e(parseInt(le().url.searchParams.get("page")||"1")));const Ve=new fr("(min-width: 768px)");let he=y(()=>Ve.current?20:15),$t=y(()=>Ve.current?1:0);const qe=[{value:"all",label:"All transactions"},{value:"BUY",label:"Buys only"},{value:"SELL",label:"Sells only"},{value:"TRANSFER_IN",label:"Received transfers"},{value:"TRANSFER_OUT",label:"Sent transfers"}],He=[{value:"desc",label:"Newest first"},{value:"asc",label:"Oldest first"}],gt=Ht(ht,300);let Ke=E("");Et(()=>{j()});function de(){const t=new URL(le().url);e(Q)?t.searchParams.set("search",e(Q)):t.searchParams.delete("search"),e(Z)!=="all"?t.searchParams.set("type",e(Z)):t.searchParams.delete("type"),e(R)!=="timestamp"?t.searchParams.set("sortBy",e(R)):t.searchParams.delete("sortBy"),e(B)!=="desc"?t.searchParams.set("sortOrder",e(B)):t.searchParams.delete("sortOrder"),e(b)!==1?t.searchParams.set("page",e(b).toString()):t.searchParams.delete("page"),Me(t.toString(),{noScroll:!0,replaceState:!0})}async function j(){c(ce,!0);try{const t=new URLSearchParams({search:e(Q),type:e(Z),sortBy:e(R),sortOrder:e(B),page:e(b).toString(),limit:e(he).toString()}),r=await fetch(`/api/transactions?${t}`);if(r.ok){const g=await r.json();c(Ye,g.transactions,!0),c(ie,g.total,!0)}else ut.error("Failed to load transactions")}catch(t){console.error("Failed to fetch transactions:",t),ut.error("Failed to load transactions")}finally{c(ce,!1)}}function ht(){c(b,1),j()}function Ge(){de()}function yt(t){t.key==="Enter"&&Ge()}jt(()=>{e(Q)!==e(Ke)&&(gt(),c(Ke,e(Q),!0))});function Ce(t){e(R)===t?c(B,e(B)==="asc"?"desc":"asc",!0):(c(R,t,!0),c(B,"desc",!0)),c(b,1),de(),j()}function xt(){c(b,1),de(),j()}function Pt(){c(b,1),de(),j()}function Je(){c(Q,""),c(Z,"all"),c(R,"timestamp"),c(B,"desc"),c(b,1),Me("/transactions",{noScroll:!0,replaceState:!0}),j(),c(Se,!1)}function bt(){c(b,1),de(),j(),c(Se,!1)}let Te=y(()=>e(Q)!==""||e(Z)!=="all"||e(R)!=="timestamp"||e(B)!=="desc"),St=y(()=>Math.ceil(e(ie)/e(he))),Ct=y(()=>(e(b)-1)*e(he)+1),kt=y(()=>Math.min(e(b)*e(he),e(ie)));function wt(t){c(b,t,!0),de(),j()}let Tt=y(()=>{var t;return((t=qe.find(r=>r.value===e(Z)))==null?void 0:t.label)||"All transactions"}),Rt=y(()=>{var t;return((t=He.find(r=>r.value===e(B)))==null?void 0:t.label)||"Newest first"}),Bt=y(()=>[{key:"type",label:"Type",class:"w-[10%] min-w-[80px]",render:(t,r)=>r.isTransfer?{component:"badge",variant:"default",text:r.isIncoming?"Received":"Sent",class:"text-xs"}:{component:"badge",variant:t==="BUY"?"success":"destructive",text:t==="BUY"?"Buy":"Sell",class:"text-xs"}},{key:"coin",label:"Asset",class:"w-[20%] min-w-[120px]",render:(t,r)=>r.isTransfer?r.isCoinTransfer&&r.coin?{component:"coin",icon:r.coin.icon,symbol:r.coin.symbol,name:`*${r.coin.symbol}`,size:6}:{component:"text",text:"Cash ($)",class:"font-medium"}:{component:"coin",icon:r.coin.icon,symbol:r.coin.symbol,name:`*${r.coin.symbol}`,size:6}},{key:"sender",label:"Sender",class:"w-[12%] min-w-[80px]",render:(t,r)=>({component:"text",text:r.isTransfer?r.sender||"Unknown":"-",class:r.isTransfer&&r.sender&&r.sender!=="Unknown"?"font-medium":"text-muted-foreground"})},{key:"recipient",label:"Receiver",class:"w-[12%] min-w-[80px]",render:(t,r)=>({component:"text",text:r.isTransfer?r.recipient||"Unknown":"-",class:r.isTransfer&&r.recipient&&r.recipient!=="Unknown"?"font-medium":"text-muted-foreground"})},{key:"quantity",label:"Quantity",class:"w-[15%] min-w-[100px] font-mono",render:(t,r)=>r.isTransfer&&t===0?"-":Gt(t)},{key:"pricePerCoin",label:"Price",class:"w-[15%] min-w-[80px] font-mono",render:(t,r)=>r.isTransfer||t===0?"-":`$${Jt(t)}`},{key:"totalBaseCurrencyAmount",label:"Total",class:"w-[15%] min-w-[80px] font-mono font-medium",render:(t,r)=>`${r.type==="TRANSFER_IN"||r.type==="BUY"?"+":"-"}${Wt(t)}`},{key:"timestamp",label:"Date",class:"w-[25%] min-w-[120px] text-muted-foreground",render:t=>Kt(t)}]);var We=zr(),Xe=l(We);mr(Xe,{title:"Transactions - Rugplay",description:"View your complete trading history and transaction records in the Rugplay cryptocurrency simulation game.",noindex:!0,keywords:"trading history game, transaction records simulator, crypto trading log, virtual trading history"});var Ze=s(Xe,2),Re=P(Ze),et=P(Re),tt=s(P(et),4),Be=P(tt),rt=P(Be);_r(rt,{class:"text-muted-foreground absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2"});var Ft=s(rt,2);dr(Ft,{placeholder:"Search by coin name or symbol...",class:"pl-10 pr-4",onblur:Ge,onkeydown:yt,get value(){return e(Q)},set value(t){c(Q,t,!0)}}),x(Be);var at=s(Be,2);o(at,()=>ar,(t,r)=>{r(t,{get open(){return e(Se)},set open(g){c(Se,g,!0)},children:(g,ye)=>{var M=Sr(),ee=l(M);o(ee,()=>er,(v,I)=>{I(v,{children:(F,ue)=>{X(F,{variant:"outline",size:"default",class:"flex items-center gap-2",children:(S,A)=>{var O=yr(),C=l(O);tr(C,{class:"h-4 w-4"});var m=s(C,2);{var f=p=>{ur(p,{variant:"secondary",class:"h-5 w-5 rounded-full p-0 text-xs",children:(k,V)=>{d();var U=u("â€¢");a(k,U)},$$slots:{default:!0}})};ge(m,p=>{e(Te)&&p(f)})}a(S,O)},$$slots:{default:!0}})},$$slots:{default:!0}})});var Y=s(ee,2);o(Y,()=>rr,(v,I)=>{I(v,{class:"w-80 p-4",align:"end",children:(F,ue)=>{var S=br(),A=P(S),O=P(A);je(O,{class:"text-sm font-medium",children:(i,_)=>{d();var n=u("Sort By");a(i,n)},$$slots:{default:!0}});var C=s(O,2),m=P(C);const f=y(()=>e(R)==="timestamp"?"default":"outline");X(m,{get variant(){return e(f)},size:"sm",onclick:()=>Ce("timestamp"),children:(i,_)=>{d();var n=u("Date");a(i,n)},$$slots:{default:!0}});var p=s(m,2);const k=y(()=>e(R)==="totalBaseCurrencyAmount"?"default":"outline");X(p,{get variant(){return e(k)},size:"sm",onclick:()=>Ce("totalBaseCurrencyAmount"),children:(i,_)=>{d();var n=u("Amount");a(i,n)},$$slots:{default:!0}});var V=s(p,2);const U=y(()=>e(R)==="quantity"?"default":"outline");X(V,{get variant(){return e(U)},size:"sm",onclick:()=>Ce("quantity"),children:(i,_)=>{d();var n=u("Quantity");a(i,n)},$$slots:{default:!0}});var L=s(V,2);const ve=y(()=>e(R)==="pricePerCoin"?"default":"outline");X(L,{get variant(){return e(ve)},size:"sm",onclick:()=>Ce("pricePerCoin"),children:(i,_)=>{d();var n=u("Price");a(i,n)},$$slots:{default:!0}}),x(C),x(A);var me=s(A,2),z=P(me);je(z,{class:"text-sm font-medium",children:(i,_)=>{d();var n=u("Sort Order");a(i,n)},$$slots:{default:!0}});var ae=s(z,2);o(ae,()=>nt,(i,_)=>{_(i,{type:"single",onValueChange:Pt,get value(){return e(B)},set value(n){c(B,n,!0)},children:(n,se)=>{var K=xr(),G=l(K);o(G,()=>lt,(J,W)=>{W(J,{class:"w-full",children:(re,fe)=>{d();var N=u();$e(()=>pe(N,e(Rt))),a(re,N)},$$slots:{default:!0}})});var oe=s(G,2);o(oe,()=>it,(J,W)=>{W(J,{children:(re,fe)=>{var N=h(),Fe=l(N);o(Fe,()=>ct,(Ae,Oe)=>{Oe(Ae,{children:(Ue,Nt)=>{var xe=h(),ze=l(xe);ke(ze,17,()=>He,Qe,(Ne,ne)=>{var Pe=h(),Ie=l(Pe);o(Ie,()=>dt,(Le,De)=>{De(Le,{get value(){return e(ne).value},get label(){return e(ne).label},children:(Ee,It)=>{d();var be=u();$e(()=>pe(be,e(ne).label)),a(Ee,be)},$$slots:{default:!0}})}),a(Ne,Pe)}),a(Ue,xe)},$$slots:{default:!0}})}),a(re,N)},$$slots:{default:!0}})}),a(n,K)},$$slots:{default:!0}})}),x(me);var q=s(me,2),te=P(q);je(te,{class:"text-sm font-medium",children:(i,_)=>{d();var n=u("Transaction Type");a(i,n)},$$slots:{default:!0}});var w=s(te,2);o(w,()=>nt,(i,_)=>{_(i,{type:"single",onValueChange:xt,get value(){return e(Z)},set value(n){c(Z,n,!0)},children:(n,se)=>{var K=Pr(),G=l(K);o(G,()=>lt,(J,W)=>{W(J,{class:"w-full",children:(re,fe)=>{d();var N=u();$e(()=>pe(N,e(Tt))),a(re,N)},$$slots:{default:!0}})});var oe=s(G,2);o(oe,()=>it,(J,W)=>{W(J,{children:(re,fe)=>{var N=h(),Fe=l(N);o(Fe,()=>ct,(Ae,Oe)=>{Oe(Ae,{children:(Ue,Nt)=>{var xe=h(),ze=l(xe);ke(ze,17,()=>qe,Qe,(Ne,ne)=>{var Pe=h(),Ie=l(Pe);o(Ie,()=>dt,(Le,De)=>{De(Le,{get value(){return e(ne).value},get label(){return e(ne).label},children:(Ee,It)=>{d();var be=u();$e(()=>pe(be,e(ne).label)),a(Ee,be)},$$slots:{default:!0}})}),a(Ne,Pe)}),a(Ue,xe)},$$slots:{default:!0}})}),a(re,N)},$$slots:{default:!0}})}),a(n,K)},$$slots:{default:!0}})}),x(q);var D=s(q,2),T=P(D);X(T,{variant:"outline",size:"sm",onclick:Je,class:"flex-1",children:(i,_)=>{d();var n=u("Reset");a(i,n)},$$slots:{default:!0}});var H=s(T,2);X(H,{size:"sm",onclick:bt,class:"flex-1",children:(i,_)=>{d();var n=u("Apply");a(i,n)},$$slots:{default:!0}}),x(D),x(S),a(F,S)},$$slots:{default:!0}})}),a(g,M)},$$slots:{default:!0}})});var At=s(at,2);X(At,{variant:"outline",size:"default",onclick:j,get disabled(){return e(ce)},children:(t,r)=>{$r(t,{class:"h-4 w-4"})},$$slots:{default:!0}}),x(tt),x(et),x(Re);var st=s(Re,2);{var Ot=t=>{var r=Cr(),g=P(r),ye=P(g);x(g);var M=s(g,2);{var ee=Y=>{X(Y,{variant:"link",size:"sm",onclick:Je,class:"h-auto p-0",children:(v,I)=>{d();var F=u("Clear all filters");a(v,F)},$$slots:{default:!0}})};ge(M,Y=>{e(Te)&&Y(ee)})}x(r),$e(()=>pe(ye,`Showing ${e(Ct)??""}-${e(kt)??""} of ${e(ie)??""} transactions`)),a(t,r)};ge(st,t=>{!e(ce)&&e(ie)>0&&t(Ot)})}var ot=s(st,2);o(ot,()=>Yt,(t,r)=>{r(t,{children:(g,ye)=>{var M=Br(),ee=l(M);o(ee,()=>Xt,(v,I)=>{I(v,{children:(F,ue)=>{var S=wr(),A=l(S);o(A,()=>Zt,(C,m)=>{m(C,{class:"flex items-center gap-2",children:(f,p)=>{var k=kr(),V=l(k);vt(V,{class:"h-5 w-5"}),d(),a(f,k)},$$slots:{default:!0}})});var O=s(A,2);o(O,()=>qt,(C,m)=>{m(C,{children:(f,p)=>{d();var k=u("Complete record of your trading activity and transfers");a(f,k)},$$slots:{default:!0}})}),a(F,S)},$$slots:{default:!0}})});var Y=s(ee,2);o(Y,()=>Vt,(v,I)=>{I(v,{children:(F,ue)=>{var S=h(),A=l(S);{var O=m=>{var f=Rr();ke(f,20,()=>Array(10),Qe,(p,k)=>{var V=Tr();a(p,V)}),x(f),a(m,f)},C=m=>{const f=y(()=>e(Te)?"No transactions match your current filters. Try adjusting your search criteria.":"You haven't made any trades or transfers yet. Start by buying coins or sending money to other users.");vr(m,{get columns(){return e(Bt)},get data(){return e(Ye)},onRowClick:p=>{p.coin&&Me(`/coin/${p.coin.symbol}`)},emptyIcon:vt,emptyTitle:"No transactions found",get emptyDescription(){return e(f)}})};ge(A,m=>{e(ce)?m(O):m(C,!1)})}a(F,S)},$$slots:{default:!0}})}),a(g,M)},$$slots:{default:!0}})});var Ut=s(ot,2);{var zt=t=>{var r=Ur(),g=P(r);o(g,()=>cr,(ye,M)=>{M(ye,{get count(){return e(ie)},get perPage(){return e(he)},get siblingCount(){return e($t)},get page(){return e(b)},onPageChange:wt,children:(Y,v)=>{let I=()=>v==null?void 0:v().pages,F=()=>v==null?void 0:v().currentPage;var ue=h(),S=l(ue);o(S,()=>sr,(A,O)=>{O(A,{children:(C,m)=>{var f=Or(),p=l(f);o(p,()=>we,(U,L)=>{L(U,{children:(ve,me)=>{var z=h(),ae=l(z);o(ae,()=>or,(q,te)=>{te(q,{children:(w,D)=>{var T=Fr(),H=l(T);gr(H,{class:"h-4 w-4"}),d(2),a(w,T)},$$slots:{default:!0}})}),a(ve,z)},$$slots:{default:!0}})});var k=s(p,2);ke(k,17,I,U=>U.key,(U,L,ve,me)=>{var z=h(),ae=l(z);{var q=w=>{var D=h(),T=l(D);o(T,()=>we,(H,i)=>{i(H,{children:(_,n)=>{var se=h(),K=l(se);o(K,()=>nr,(G,oe)=>{oe(G,{})}),a(_,se)},$$slots:{default:!0}})}),a(w,D)},te=w=>{var D=h(),T=l(D);o(T,()=>we,(H,i)=>{i(H,{children:(_,n)=>{var se=h(),K=l(se);const G=y(()=>F()===e(L).value);o(K,()=>lr,(oe,J)=>{J(oe,{get page(){return e(L)},get isActive(){return e(G)},children:(W,re)=>{d();var fe=u();$e(()=>pe(fe,e(L).value)),a(W,fe)},$$slots:{default:!0}})}),a(_,se)},$$slots:{default:!0}})}),a(w,D)};ge(ae,w=>{e(L).type==="ellipsis"?w(q):w(te,!1)})}a(U,z)});var V=s(k,2);o(V,()=>we,(U,L)=>{L(U,{children:(ve,me)=>{var z=h(),ae=l(z);o(ae,()=>ir,(q,te)=>{te(q,{children:(w,D)=>{var T=Ar(),H=s(l(T),2);hr(H,{class:"h-4 w-4"}),a(w,T)},$$slots:{default:!0}})}),a(ve,z)},$$slots:{default:!0}})}),a(C,f)},$$slots:{default:!0}})}),a(Y,ue)},$$slots:{default:!0}})}),x(r),a(t,r)};ge(Ut,t=>{!e(ce)&&e(St)>1&&t(zt)})}x(Ze),a(mt,We),Mt(),_t()}export{da as component};
