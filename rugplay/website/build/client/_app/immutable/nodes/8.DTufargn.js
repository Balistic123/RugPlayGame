import{l as gr,i as xr,c as Ee,a as t,p as fr,f as n,t as ae,s as p,g as zt,b as tr,d as Vr,j as qr}from"../chunks/BiLdCT7w.js";import{o as Kr}from"../chunks/DBnYf9wq.js";import{i as d,p as qt,s as r,n as j,t as T,c as s,e as m,b as xe,g as e,d as F,r as a,a as Kt,f as Lt,h as Pt}from"../chunks/Dc9Cd6uL.js";import{i as J}from"../chunks/4JrI1xkN.js";import{e as Bt,i as Mt}from"../chunks/DT6MbhOo.js";import{c as v}from"../chunks/DKQvO5e2.js";import{C as Ge}from"../chunks/BE8a_9Ge.js";import{C as et}from"../chunks/D0g6TdLa.js";import{p as Wr,j as Vt,e as _r,i as pr,y as Jr,z as Qr}from"../chunks/aor5dgAF.js";import{C as ot}from"../chunks/b_f0gCBc.js";import{C as lt}from"../chunks/jS9pjJ83.js";import{R as Xr,S as Zr,a as Gr,b as ea,c as ta}from"../chunks/BZ8NTllV.js";import{B as gt}from"../chunks/BvtTpaCk.js";import{B as pt}from"../chunks/PVG7Em25.js";import{A as rr,a as ar,b as sr}from"../chunks/CqEP-Wsq.js";import{R as br,H as yr,a as wr,U as Pr}from"../chunks/RnzTeRby.js";import{D as Cr,R as kr}from"../chunks/BpTyYBFh.js";import{I as ra}from"../chunks/5J9eaWb4.js";import{L as aa}from"../chunks/Ct87CVwI.js";import{P as sa,b as oa}from"../chunks/DORihvSD.js";import{t as Ct}from"../chunks/BR_bh9L_.js";import{D as Sr,a as Tr,b as Ar}from"../chunks/CpfRlYS9.js";import{D as la}from"../chunks/CTgw-KxQ.js";import{L as er}from"../chunks/khItcEfd.js";import{T as Ht}from"../chunks/CvioT2Jg.js";import{T as Yt}from"../chunks/BQ1g71Ea.js";import{T as na}from"../chunks/C63IjmiN.js";import{U as Ur}from"../chunks/CTHXnj9k.js";import{g as kt}from"../chunks/BnkorlfL.js";import{S as Lr}from"../chunks/BUFrtusw.js";import{w as xt,b as ia}from"../chunks/rNNGKTep.js";import{I as Br,s as Fr}from"../chunks/BFn_PWCM.js";import{S as da,D as ca}from"../chunks/DOGd6fBh.js";import{S}from"../chunks/DZFQxItp.js";import{S as va}from"../chunks/BPyYV3CN.js";import{D as ua}from"../chunks/E71pIGAW.js";import{U as Gt}from"../chunks/Bu7XxLTn.js";import{N as ma,E as fa,x as _a,k as pa}from"../chunks/BFsxmWI9.js";import{C as $a}from"../chunks/KLYSBcZv.js";import{S as ha}from"../chunks/BGGxhLCO.js";import{C as $r}from"../chunks/CaMfMQj8.js";import{C as ga}from"../chunks/D6BgCw_H.js";function xa(Oe,i){const Ce=gr(i,["children","$$slots","$$events","$$legacy"]);Br(Oe,xr({name:"heart"},()=>Ce,{iconNode:[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"}]],children:(K,N)=>{var y=Ee(),o=d(y);Fr(o,i,"default",{}),t(K,y)},$$slots:{default:!0}}))}function ba(Oe,i){const Ce=gr(i,["children","$$slots","$$events","$$legacy"]);Br(Oe,xr({name:"message-circle"},()=>Ce,{iconNode:[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z"}]],children:(K,N)=>{var y=Ee(),o=d(y);Fr(o,i,"default",{}),t(K,y)},$$slots:{default:!0}}))}var ya=n("<!> ",1),wa=n("<!> ",1),Pa=n("<!> <!>",1),Ca=n("<br/> ",1),ka=n('<p class="text-muted-foreground text-xs"> <!></p>'),Sa=n('<p class="text-muted-foreground text-xs"> </p>'),Ta=n('<div class="bg-muted/50 rounded-lg p-3"><div class="flex items-center justify-between"><span class="text-sm font-medium"> </span> <span class="font-bold"> </span></div> <p class="text-muted-foreground mt-1 text-xs">AMM estimation - includes slippage from pool impact</p></div>'),Aa=n("<!> Processing...",1),Ua=n("<!> <!>",1),La=n('<!> <div class="space-y-4"><div class="space-y-2"><!> <div class="flex gap-2"><!> <!></div> <!></div> <!> <!></div> <!>',1);function hr(Oe,i){qt(i,!0);const[Ce,Z]=tr(),K=()=>zt(sa,"$PORTFOLIO_SUMMARY",Ce);let N=fr(i,"open",15,!1),y=fr(i,"userHolding",3,0),o=xe(""),ne=xe(!1),W=F(()=>parseFloat(e(o))||0),Le=F(()=>i.coin.currentPrice||0),A=F(()=>i.type==="SELL"&&i.coin?Math.min(y(),Math.floor(Number(i.coin.poolCoinAmount)*.995)):y()),fe=F(()=>ze(e(W),i.type,e(Le))),Be=F(()=>e(W)>0),Ae=F(()=>K()?K().baseCurrencyBalance:0),Ie=F(()=>i.type==="BUY"?e(W)<=e(Ae):e(W)<=y()),Ke=F(()=>e(Be)&&e(Ie)&&!e(ne));function ze(ce,ke,u){if(!ce||!u||!i.coin)return{result:0};const D=Number(i.coin.poolCoinAmount),H=Number(i.coin.poolBaseCurrencyAmount);if(D<=0||H<=0)return{result:0};const f=D*H;if(ke==="BUY"){const $=H+ce,U=f/$;return{result:D-U}}else{const $=D+ce,U=f/$;return{result:H-U}}}function _e(){N(!1),m(o,""),m(ne,!1)}async function be(){var ce;if(e(Ke)){m(ne,!0);try{const ke=await fetch(`/api/coin/${i.coin.symbol}/trade`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:i.type,amount:e(W)})}),u=await ke.json();if(!ke.ok)throw new Error(u.message||"Trade failed");Ct.success(`${i.type==="BUY"?"Bought":"Sold"} successfully!`,{description:i.type==="BUY"?`Purchased ${u.coinsBought.toFixed(6)} ${i.coin.symbol} for $${u.totalCost.toFixed(6)}`:`Sold ${u.coinsSold.toFixed(6)} ${i.coin.symbol} for $${u.totalReceived.toFixed(6)}`}),(ce=i.onSuccess)==null||ce.call(i),_e()}catch(ke){Ct.error("Trade failed",{description:ke.message})}finally{m(ne,!1)}}}function Je(){i.type==="SELL"?m(o,e(A).toString(),!0):K()&&m(o,e(Ae).toString(),!0)}var Qe=Ee(),Fe=d(Qe);v(Fe,()=>kr,(ce,ke)=>{ke(ce,{get open(){return N()},set open(u){N(u)},children:(u,D)=>{var H=Ee(),f=d(H);v(f,()=>Cr,($,U)=>{U($,{class:"sm:max-w-md",children:(G,E)=>{var w=La(),Y=d(w);v(Y,()=>Sr,(_,se)=>{se(_,{children:(z,ve)=>{var l=Pa(),c=d(l);v(c,()=>Tr,(L,b)=>{b(L,{class:"flex items-center gap-2",children:(C,oe)=>{var ue=Ee(),Ve=d(ue);{var nt=Pe=>{var je=ya(),it=d(je);Ht(it,{class:"h-5 w-5 text-green-500"});var bt=r(it);T(()=>p(bt,` Buy ${i.coin.symbol??""}`)),t(Pe,je)},ut=Pe=>{var je=wa(),it=d(je);Yt(it,{class:"h-5 w-5 text-red-500"});var bt=r(it);T(()=>p(bt,` Sell ${i.coin.symbol??""}`)),t(Pe,je)};J(Ve,Pe=>{i.type==="BUY"?Pe(nt):Pe(ut,!1)})}t(C,ue)},$$slots:{default:!0}})});var P=r(c,2);v(P,()=>Ar,(L,b)=>{b(L,{children:(C,oe)=>{j();var ue=ae();T(Ve=>p(ue,`Current price: $${Ve??""} per ${i.coin.symbol??""}`),[()=>i.coin.currentPrice.toFixed(6)]),t(C,ue)},$$slots:{default:!0}})}),t(z,l)},$$slots:{default:!0}})});var g=r(Y,2),B=s(g),I=s(B);aa(I,{for:"amount",children:(_,se)=>{j();var z=ae();T(()=>p(z,i.type==="BUY"?"Amount to spend ($)":`Amount (${i.coin.symbol})`)),t(_,z)},$$slots:{default:!0}});var R=r(I,2),Q=s(R);const pe=F(()=>i.type==="BUY"?"0.01":"1");ra(Q,{id:"amount",type:"number",get step(){return e(pe)},min:"0",placeholder:"0.00",class:"flex-1",get value(){return e(o)},set value(_){m(o,_,!0)}});var ye=r(Q,2);pt(ye,{variant:"outline",size:"sm",onclick:Je,children:(_,se)=>{j();var z=ae("Max");t(_,z)},$$slots:{default:!0}}),a(R);var De=r(R,2);{var X=_=>{var se=ka(),z=s(se),ve=r(z);{var l=c=>{var P=Ca(),L=r(d(P));T(b=>p(L,`Max sellable: ${b??""} ${i.coin.symbol??""} (pool limit)`),[()=>e(A).toFixed(0)]),t(c,P)};J(ve,c=>{e(A)<y()&&c(l)})}a(se),T(c=>p(z,`Available: ${c??""}
						${i.coin.symbol??""} `),[()=>y().toFixed(6)]),t(_,se)},ee=(_,se)=>{{var z=ve=>{var l=Sa(),c=s(l);a(l),T(P=>p(c,`Balance: $${P??""}`),[()=>e(Ae).toFixed(6)]),t(ve,l)};J(_,ve=>{K()&&ve(z)},se)}};J(De,_=>{i.type==="SELL"?_(X):_(ee,!1)})}a(B);var $e=r(B,2);{var tt=_=>{var se=Ta(),z=s(se),ve=s(z),l=s(ve,!0);a(ve);var c=r(ve,2),P=s(c,!0);a(c),a(z),j(2),a(se),T(L=>{p(l,i.type==="BUY"?`${i.coin.symbol} you'll get:`:"You'll receive:"),p(P,L)},[()=>i.type==="BUY"?`~${e(fe).result.toFixed(6)} ${i.coin.symbol}`:`~$${e(fe).result.toFixed(6)}`]),t(_,se)};J($e,_=>{e(Be)&&_(tt)})}var Me=r($e,2);{var we=_=>{gt(_,{variant:"destructive",class:"text-xs",children:(se,z)=>{j();var ve=ae();T(()=>p(ve,i.type==="BUY"?"Insufficient funds":"Insufficient coins")),t(se,ve)},$$slots:{default:!0}})};J(Me,_=>{!e(Ie)&&e(Be)&&_(we)})}a(g);var rt=r(g,2);v(rt,()=>la,(_,se)=>{se(_,{class:"flex gap-2",children:(z,ve)=>{var l=Ua(),c=d(l);pt(c,{variant:"outline",onclick:_e,get disabled(){return e(ne)},children:(C,oe)=>{j();var ue=ae("Cancel");t(C,ue)},$$slots:{default:!0}});var P=r(c,2);const L=F(()=>!e(Ke)),b=F(()=>i.type==="BUY"?"default":"destructive");pt(P,{onclick:be,get disabled(){return e(L)},get variant(){return e(b)},children:(C,oe)=>{var ue=Ee(),Ve=d(ue);{var nt=Pe=>{var je=Aa(),it=d(je);er(it,{class:"h-4 w-4 animate-spin"}),j(),t(Pe,je)},ut=Pe=>{var je=ae();T(()=>p(je,`${i.type==="BUY"?"Buy":"Sell"} ${i.coin.symbol??""}`)),t(Pe,je)};J(Ve,Pe=>{e(ne)?Pe(nt):Pe(ut,!1)})}t(C,ue)},$$slots:{default:!0}}),t(z,l)},$$slots:{default:!0}})}),t(G,w)},$$slots:{default:!0}})}),t(u,H)},$$slots:{default:!0}})}),t(Oe,Qe),Kt(),Z()}var Ba=n("<!> ",1),Fa=n("<!> Posting...",1),Da=n("<!> Post",1),Ma=n('<div class="space-y-3"><div class="relative"><!> <kbd class="bg-muted pointer-events-none absolute bottom-2 right-2 hidden h-5 select-none items-center gap-1 rounded border px-1.5 font-mono text-[10px] font-medium opacity-70 sm:flex"><span class="text-xs">âŒ˜</span>Enter</kbd></div> <div class="flex justify-between"><span class="text-muted-foreground text-xs"> </span> <!></div></div>'),Na=n('<div class="text-center"><p class="text-muted-foreground mb-3 text-sm">Sign in to join the discussion</p> <!></div>'),Ea=n('<div class="text-center"><!></div>'),Ia=n('<div class="text-center"><p class="text-muted-foreground mt-2 text-sm">No comments yet. Be the first to share your thoughts!</p></div>'),ja=(Oe,i)=>kt(`/user/${e(i).userUsername}`),Ra=n("<!> <!>",1),Oa=n('<span class="block truncate"> </span>'),Ha=n("<!> <!>",1),Ya=(Oe,i)=>kt(`/user/${e(i).userUsername}`),za=n('<span class="truncate"> </span>'),Va=(Oe,i,Ce)=>i(e(Ce).id),qa=n('<button class="text-primary hover:text-primary/80 cursor-pointer text-xs font-medium transition-colors hover:underline"> </button>'),Ka=n('<span class="text-xs"> </span>'),Wa=n("<!> <!>",1),Ja=n('<div class="border-border border-b pb-4 last:border-b-0"><div class="flex items-start gap-3"><button class="cursor-pointer"><!></button> <div class="flex-1 space-y-1"><div class="flex items-center gap-2"><!> <button class="max-w-[80px] flex-shrink-0 cursor-pointer sm:max-w-none"><!></button> <span class="text-muted-foreground flex-shrink-0 whitespace-nowrap text-xs"> </span></div> <div class="space-y-1"><p class="whitespace-pre-wrap break-words text-sm leading-relaxed" style="word-break: break-word; overflow-wrap: break-word;"> </p> <!></div></div> <div class="flex items-center"><!></div></div></div>'),Qa=n('<div class="space-y-4"></div>'),Xa=n("<!> <!>",1),Za=n("<!> <!>",1),Ga=n("<!> <!>",1);function es(Oe,i){qt(i,!0);const[Ce,Z]=tr(),K=()=>zt(Ur,"$USER_DATA",Ce);let N=xe(Lt([])),y=xe(""),o=xe(!1),ne=xe(!0),W=xe(!1),Le=xe(Lt(new Set));const A=50,fe=3;Pt(()=>(xt.setCoin(i.coinSymbol),xt.subscribeToComments(i.coinSymbol,Be),()=>{xt.unsubscribeFromComments(i.coinSymbol)}));function Be(u){var D;switch(u.type){case"new_comment":e(N).some($=>$.id===u.data.id)||m(N,[u.data,...e(N).slice(0,A-1)],!0);break;case"comment_liked":const f=e(N).findIndex($=>$.id===u.data.commentId);f!==-1&&(e(N)[f]={...e(N)[f],likesCount:u.data.likesCount,isLikedByUser:u.data.userId===Number((D=K())==null?void 0:D.id)?u.data.isLikedByUser:e(N)[f].isLikedByUser});break}}async function Ae(){try{const u=await fetch(`/api/coin/${i.coinSymbol}/comments`);if(u.ok){const D=await u.json();m(N,D.comments.slice(0,A),!0)}}catch(u){console.error("Failed to load comments:",u)}finally{m(ne,!1)}}async function Ie(){if(!K()){m(W,!0);return}if(e(y).trim()){m(o,!0);try{const u=await fetch(`/api/coin/${i.coinSymbol}/comments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e(y).trim()})});if(u.ok){const D=await u.json();e(N).some(f=>f.id===D.comment.id)||m(N,[D.comment,...e(N).slice(0,A-1)],!0),m(y,"")}else{const D=await u.json();Ct.error(D.message||"Failed to post comment")}}catch{Ct.error("Failed to post comment")}finally{m(o,!1)}}}function Ke(u){u.key==="Enter"&&(u.ctrlKey||u.metaKey)&&(u.preventDefault(),Ie())}async function ze(u){if(!K()){kt("/");return}const D=e(N).findIndex($=>$.id===u);if(D===-1)return;const H=e(N)[D],f=H.isLikedByUser;e(N)[D]={...H,isLikedByUser:!f,likesCount:f?H.likesCount-1:H.likesCount+1},fetch(`/api/coin/${i.coinSymbol}/comments/${u}/like`,{method:f?"DELETE":"POST",headers:{"Content-Type":"application/json"}}).catch(()=>{e(N)[D]=H})}function _e(u){if(!K()){m(W,!0);return}ze(u)}function be(u){e(Le).has(u)?e(Le).delete(u):e(Le).add(u),m(Le,new Set(e(Le)),!0)}function Je(u){return u.split(`
`).length>fe}function Qe(u){return u.split(`
`).slice(0,fe).join(`
`)}Pt(()=>{Ae()});var Fe=Ga(),ce=d(Fe);Lr(ce,{get open(){return e(W)},set open(u){m(W,u,!0)}});var ke=r(ce,2);v(ke,()=>Ge,(u,D)=>{D(u,{children:(H,f)=>{var $=Za(),U=d($);v(U,()=>ot,(E,w)=>{w(E,{children:(Y,g)=>{var B=Ee(),I=d(B);v(I,()=>lt,(R,Q)=>{Q(R,{class:"flex items-center gap-2",children:(pe,ye)=>{var De=Ba(),X=d(De);ba(X,{class:"h-5 w-5"});var ee=r(X);T(()=>p(ee,` Comments (${e(N).length??""})`)),t(pe,De)},$$slots:{default:!0}})}),t(Y,B)},$$slots:{default:!0}})});var G=r(U,2);v(G,()=>et,(E,w)=>{w(E,{class:"space-y-4",children:(Y,g)=>{var B=Xa(),I=d(B);{var R=X=>{var ee=Ma(),$e=s(ee),tt=s($e);na(tt,{placeholder:"Share your thoughts about this coin...",class:"min-h-[80px] w-full break-words pb-8 pr-20",style:"word-break: break-word; overflow-wrap: break-word;",maxlength:500,onkeydown:Ke,get value(){return e(y)},set value(z){m(y,z,!0)}}),j(2),a($e);var Me=r($e,2),we=s(Me),rt=s(we);a(we);var _=r(we,2);const se=F(()=>!e(y).trim()||e(o));pt(_,{onclick:Ie,get disabled(){return e(se)},size:"sm",children:(z,ve)=>{var l=Ee(),c=d(l);{var P=b=>{var C=Fa(),oe=d(C);er(oe,{class:"h-4 w-4 animate-spin"}),j(),t(b,C)},L=b=>{var C=Da(),oe=d(C);da(oe,{class:"h-4 w-4"}),j(),t(b,C)};J(c,b=>{e(o)?b(P):b(L,!1)})}t(z,l)},$$slots:{default:!0}}),a(Me),a(ee),T(()=>p(rt,`${e(y).length??""}/500 characters`)),t(X,ee)},Q=X=>{var ee=Na(),$e=r(s(ee),2);pt($e,{onclick:()=>m(W,!0),size:"sm",children:(tt,Me)=>{j();var we=ae("Sign In");t(tt,we)},$$slots:{default:!0}}),a(ee),t(X,ee)};J(I,X=>{K()?X(R):X(Q,!1)})}var pe=r(I,2);{var ye=X=>{var ee=Ea(),$e=s(ee);er($e,{class:"mx-auto h-6 w-6 animate-spin"}),a(ee),t(X,ee)},De=(X,ee)=>{{var $e=Me=>{var we=Ia();t(Me,we)},tt=Me=>{var we=Qa();Bt(we,21,()=>e(N),rt=>rt.id,(rt,_)=>{var se=Ja();const z=F(()=>e(Le).has(e(_).id)),ve=F(()=>Je(e(_).content)),l=F(()=>e(ve)&&!e(z)?Qe(e(_).content):e(_).content);var c=s(se),P=s(c);P.__click=[ja,_];var L=s(P);v(L,()=>rr,(Xe,dt)=>{dt(Xe,{class:"h-8 w-8",children:(Ze,ft)=>{var _t=Ra(),$t=d(_t);const yt=F(()=>Vt(e(_).userImage));v($t,()=>ar,(st,mt)=>{mt(st,{get src(){return e(yt)},get alt(){return e(_).userName}})});var ct=r($t,2);v(ct,()=>sr,(st,mt)=>{mt(st,{children:(Ft,St)=>{j();var Tt=ae();T(At=>p(Tt,At),[()=>{var At;return((At=e(_).userName)==null?void 0:At.charAt(0))||"?"}]),t(Ft,Tt)},$$slots:{default:!0}})}),t(Ze,_t)},$$slots:{default:!0}})}),a(P);var b=r(P,2),C=s(b),oe=s(C);v(oe,()=>br,(Xe,dt)=>{dt(Xe,{children:(Ze,ft)=>{var _t=Ha(),$t=d(_t);v($t,()=>yr,(ct,st)=>{st(ct,{class:"min-w-0 max-w-[120px] flex-shrink cursor-pointer text-sm font-medium underline-offset-4 hover:underline focus-visible:outline-2 focus-visible:outline-offset-8 sm:max-w-[180px] sm:text-base",onclick:()=>kt(`/user/${e(_).userUsername}`),children:(mt,Ft)=>{var St=Oa(),Tt=s(St,!0);a(St),T(()=>p(Tt,e(_).userName)),t(mt,St)},$$slots:{default:!0}})});var yt=r($t,2);v(yt,()=>wr,(ct,st)=>{st(ct,{class:"w-80",side:"top",sideOffset:3,children:(mt,Ft)=>{Pr(mt,{get userId(){return e(_).userId}})},$$slots:{default:!0}})}),t(Ze,_t)},$$slots:{default:!0}})});var ue=r(oe,2);ue.__click=[Ya,_];var Ve=s(ue);gt(Ve,{variant:"outline",class:"w-full justify-start text-xs",children:(Xe,dt)=>{var Ze=za(),ft=s(Ze);a(Ze),T(()=>p(ft,`@${e(_).userUsername??""}`)),t(Xe,Ze)},$$slots:{default:!0}}),a(ue);var nt=r(ue,2),ut=s(nt,!0);a(nt),a(C);var Pe=r(C,2),je=s(Pe),it=s(je,!0);a(je);var bt=r(je,2);{var Nt=Xe=>{var dt=qa();dt.__click=[Va,be,_];var Ze=s(dt,!0);a(dt),T(()=>p(Ze,e(z)?"Read less":"Read more...")),t(Xe,dt)};J(bt,Xe=>{e(ve)&&Xe(Nt)})}a(Pe),a(b);var Et=r(b,2),It=s(Et);const Wt=F(()=>e(_).isLikedByUser?"text-red-500 hover:text-red-600":"text-muted-foreground hover:text-foreground");pt(It,{variant:"ghost",size:"sm",onclick:()=>_e(e(_).id),get class(){return`flex h-auto items-center gap-1 p-2 ${e(Wt)??""}`},children:(Xe,dt)=>{var Ze=Wa(),ft=d(Ze);const _t=F(()=>e(_).isLikedByUser?"fill-current":"");xa(ft,{get class(){return`h-4 w-4 ${e(_t)??""}`}});var $t=r(ft,2);{var yt=ct=>{var st=Ka(),mt=s(st,!0);a(st),T(()=>p(mt,e(_).likesCount)),t(ct,st)};J($t,ct=>{e(_).likesCount>0&&ct(yt)})}t(Xe,Ze)},$$slots:{default:!0}}),a(Et),a(c),a(se),T(Xe=>{p(ut,Xe),p(it,e(l))},[()=>Wr(e(_).createdAt)]),t(rt,se)}),a(we),t(Me,we)};J(X,Me=>{e(N).length===0?Me($e):Me(tt,!1)},ee)}};J(pe,X=>{e(ne)?X(ye):X(De,!1)})}t(Y,B)},$$slots:{default:!0}})}),t(H,$)},$$slots:{default:!0}})}),t(Oe,Fe),Kt(),Z()}Vr(["click"]);var ts=n('<div class="flex items-center gap-2"><div class="flex min-w-0 flex-1 items-center gap-3"><!> <div class="min-w-0 flex-1 space-y-1"><!> <!></div></div> <div class="flex flex-shrink-0 items-center gap-1.5"><div class="hidden sm:block"><!></div> <div class="flex flex-col items-end gap-0.5"><!> <!></div></div></div>'),rs=n('<div class="space-y-4"></div>');function Dr(Oe){var i=rs();Bt(i,4,()=>Array(3),Mt,(Ce,Z)=>{var K=ts(),N=s(K),y=s(N);S(y,{class:"h-8 w-8 flex-shrink-0 rounded-full"});var o=r(y,2),ne=s(o);S(ne,{class:"h-4 w-24"});var W=r(ne,2);S(W,{class:"h-3 w-16"}),a(o),a(N);var Le=r(N,2),A=s(Le),fe=s(A);S(fe,{class:"h-5 w-12 rounded-full"}),a(A);var Be=r(A,2),Ae=s(Be);S(Ae,{class:"h-3 w-16"});var Ie=r(Ae,2);S(Ie,{class:"h-3 w-12"}),a(Be),a(Le),a(K),t(Ce,K)}),a(i),t(Oe,i)}var as=n("<!> <!>",1),ss=n('<div class="flex items-center justify-between"><!> <div class="w-24"><!></div></div>'),os=n("<!> <!>",1),ls=n('<div class="space-y-3"><!> <!></div>'),ns=n("<!> <!>",1),is=n('<div class="space-y-5"><div><!> <div class="mt-4 space-y-3"><div class="flex justify-between"><!> <!></div> <div class="flex justify-between"><!> <!></div></div></div> <div><!> <div class="mt-4 space-y-3"><div class="flex justify-between"><!> <!></div> <div class="flex justify-between"><!> <!></div></div></div></div>'),ds=n("<!> <!>",1),cs=n("<!> <!>",1),vs=n("<!> <!>",1),us=n("<!> <!>",1),ms=n("<!> <!>",1),fs=n('<div class="flex gap-3 border-b pb-4 last:border-b-0"><!> <div class="flex-1"><div class="mb-2 flex items-center gap-2"><!> <!></div> <!> <!></div></div>'),_s=n('<div class="space-y-4"></div>'),ps=n("<!> <!>",1),$s=n('<header class="mb-8"><div class="mb-4 flex flex-col gap-5 sm:flex-row sm:items-start sm:justify-between"><div class="flex items-center gap-3 sm:gap-4"><!> <div class="min-w-0 flex-1"><!> <div class="mt-1 flex flex-wrap items-center gap-2"><!></div></div></div> <div class="flex flex-col items-start gap-2 sm:items-end sm:text-right"><!> <div class="flex items-center gap-2"><!></div></div></div> <div class="text-muted-foreground mt-6 flex flex-wrap items-center gap-2 text-sm"><!> <!> <!></div></header> <div class="grid gap-6"><div class="grid grid-cols-1 gap-6 lg:grid-cols-3"><div class="lg:col-span-2"><!></div> <div class="space-y-6 lg:col-span-1"><!> <!> <!></div></div> <div class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4"></div> <!></div>',1);function hs(Oe){var i=$s(),Ce=d(i),Z=s(Ce),K=s(Z),N=s(K);S(N,{class:"h-12 w-12 rounded-lg sm:h-16 sm:w-16"});var y=r(N,2),o=s(y);S(o,{class:"mb-2 h-6 w-40 sm:h-10 sm:w-48"});var ne=r(o,2),W=s(ne);S(W,{class:"h-5 w-12 sm:h-6 sm:w-24"}),a(ne),a(y),a(K);var Le=r(K,2),A=s(Le);S(A,{class:"h-6 w-28 sm:h-8 sm:w-32"});var fe=r(A,2),Be=s(fe);S(Be,{class:"h-5 w-12 sm:h-6 sm:w-24"}),a(fe),a(Le),a(Z);var Ae=r(Z,2),Ie=s(Ae);S(Ie,{class:"h-4 w-20"});var Ke=r(Ie,2);S(Ke,{class:"h-4 w-4 rounded-full"});var ze=r(Ke,2);S(ze,{class:"h-4 w-40"}),a(Ae),a(Ce);var _e=r(Ce,2),be=s(_e),Je=s(be),Qe=s(Je);Ge(Qe,{class:"flex h-full flex-col",children:(f,$)=>{var U=os(),G=d(U);ot(G,{class:"pb-4",children:(w,Y)=>{var g=ss(),B=s(g);lt(B,{class:"flex items-center gap-2",children:(Q,pe)=>{var ye=as(),De=d(ye);S(De,{class:"h-5 w-5"});var X=r(De,2);S(X,{class:"h-6 w-32"}),t(Q,ye)},$$slots:{default:!0}});var I=r(B,2),R=s(I);S(R,{class:"h-10 w-full"}),a(I),a(g),t(w,g)},$$slots:{default:!0}});var E=r(G,2);et(E,{class:"flex-1 pt-0",children:(w,Y)=>{S(w,{class:"h-full min-h-[500px] w-full"})},$$slots:{default:!0}}),t(f,U)},$$slots:{default:!0}}),a(Je);var Fe=r(Je,2),ce=s(Fe);Ge(ce,{class:"gap-3",children:(f,$)=>{var U=ns(),G=d(U);ot(G,{children:(w,Y)=>{lt(w,{children:(g,B)=>{S(g,{class:"h-6 w-24"})},$$slots:{default:!0}})},$$slots:{default:!0}});var E=r(G,2);et(E,{children:(w,Y)=>{var g=ls(),B=s(g);S(B,{class:"h-11 w-full"});var I=r(B,2);S(I,{class:"h-11 w-full"}),a(g),t(w,g)},$$slots:{default:!0}}),t(f,U)},$$slots:{default:!0}});var ke=r(ce,2);Ge(ke,{children:(f,$)=>{et(f,{children:(U,G)=>{var E=is(),w=s(E),Y=s(w);S(Y,{class:"mb-3 h-5 w-32"});var g=r(Y,2),B=s(g),I=s(B);S(I,{class:"h-4 w-16"});var R=r(I,2);S(R,{class:"h-4 w-20"}),a(B);var Q=r(B,2),pe=s(Q);S(pe,{class:"h-4 w-24"});var ye=r(pe,2);S(ye,{class:"h-4 w-20"}),a(Q),a(g),a(w);var De=r(w,2),X=s(De);S(X,{class:"mb-3 h-5 w-20"});var ee=r(X,2),$e=s(ee),tt=s($e);S(tt,{class:"h-4 w-24"});var Me=r(tt,2);S(Me,{class:"h-4 w-20"}),a($e);var we=r($e,2),rt=s(we);S(rt,{class:"h-4 w-20"});var _=r(rt,2);S(_,{class:"h-4 w-20"}),a(we),a(ee),a(De),a(E),t(U,E)},$$slots:{default:!0}})},$$slots:{default:!0}});var u=r(ke,2);Ge(u,{class:"gap-2",children:(f,$)=>{var U=ds(),G=d(U);ot(G,{children:(w,Y)=>{lt(w,{class:"flex items-center gap-2",children:(g,B)=>{j();var I=ae("Top Holders");t(g,I)},$$slots:{default:!0}})},$$slots:{default:!0}});var E=r(G,2);et(E,{class:"relative",children:(w,Y)=>{Dr(w)},$$slots:{default:!0}}),t(f,U)},$$slots:{default:!0}}),a(Fe),a(be);var D=r(be,2);Bt(D,4,()=>Array(4),Mt,(f,$)=>{Ge(f,{class:"gap-1",children:(U,G)=>{var E=us(),w=d(E);ot(w,{children:(g,B)=>{lt(g,{class:"flex items-center gap-2 text-sm font-medium",children:(I,R)=>{var Q=cs(),pe=d(Q);S(pe,{class:"h-4 w-4"});var ye=r(pe,2);S(ye,{class:"h-4 w-20"}),t(I,Q)},$$slots:{default:!0}})},$$slots:{default:!0}});var Y=r(w,2);et(Y,{children:(g,B)=>{var I=vs(),R=d(I);S(R,{class:"mb-1 h-6 w-24"});var Q=r(R,2);S(Q,{class:"h-3 w-16"}),t(g,I)},$$slots:{default:!0}}),t(U,E)},$$slots:{default:!0}})}),a(D);var H=r(D,2);Ge(H,{children:(f,$)=>{var U=ps(),G=d(U);ot(G,{children:(w,Y)=>{lt(w,{class:"flex items-center gap-2",children:(g,B)=>{var I=ms(),R=d(I);S(R,{class:"h-5 w-5"});var Q=r(R,2);S(Q,{class:"h-6 w-20"}),t(g,I)},$$slots:{default:!0}})},$$slots:{default:!0}});var E=r(G,2);et(E,{children:(w,Y)=>{var g=_s();Bt(g,4,()=>Array(3),Mt,(B,I)=>{var R=fs(),Q=s(R);S(Q,{class:"h-8 w-8 rounded-full"});var pe=r(Q,2),ye=s(pe),De=s(ye);S(De,{class:"h-4 w-24"});var X=r(De,2);S(X,{class:"h-3 w-16"}),a(ye);var ee=r(ye,2);S(ee,{class:"h-4 w-full"});var $e=r(ee,2);S($e,{class:"mt-1 h-4 w-3/4"}),a(pe),a(R),t(B,R)}),a(g),t(w,g)},$$slots:{default:!0}}),t(f,U)},$$slots:{default:!0}}),a(_e),t(Oe,i)}var gs=n('<div class="py-4 text-center"><!> <p class="text-muted-foreground text-sm">No holders found</p></div>'),xs=n("<!> <!>",1),bs=n('<div class="flex items-center gap-2"><div class="flex min-w-0 flex-1 cursor-pointer items-center gap-3 border-none bg-transparent p-0 text-left"><!> <div class="min-w-0 flex-1"><p class="truncate text-sm font-medium"> </p> <p class="text-muted-foreground truncate text-xs"> </p></div></div> <div class="flex flex-shrink-0 items-center gap-1.5 text-right"><div class="hidden sm:block"><!></div> <div class="flex flex-col items-end gap-0.5"><p class="text-muted-foreground font-mono text-xs"> </p> <p class="text-muted-foreground/80 font-mono text-xs font-medium"> </p></div></div></div>'),ys=n('<div class="space-y-3"></div>'),ws=n('<div class="from-card/80 pointer-events-none absolute inset-0 bg-gradient-to-t via-transparent to-transparent"></div>'),Ps=n("<!> <!>",1),Cs=n("<!> <!>",1),ks=n("<!> ",1),Ss=n("<!> <!>",1),Ts=n('<div class="bg-card p-2"><!></div>'),As=n(`<div class="flex h-full items-center justify-center py-12 text-center"><div><!> <h3 class="mb-2 text-lg font-semibold">No holders found</h3> <p class="text-muted-foreground">This coin doesn't have any holders yet.</p></div></div>`),Us=n('<!> <div class="min-h-0 flex-1"><!></div>',1),Ls=n("<!> <!>",1);function Bs(Oe,i){qt(i,!0);let Ce=xe(!0),Z=xe(null),K=xe(!1);async function N(){try{const A=await fetch(`/api/coin/${i.coinSymbol}/holders?limit=50`);if(!A.ok){if(A.status===404)return;throw new Error("Failed to fetch holders")}const fe=await A.json();m(Z,fe,!0)}catch(A){console.error("Failed to fetch holders:",A),Ct.error("Failed to load top holders")}finally{m(Ce,!1)}}Pt(()=>{i.coinSymbol&&(m(Ce,!0),m(Z,null),N())});let y=F(()=>[{key:"rank",label:"Rank",class:"w-[10%] min-w-[60px]",render:A=>`#${A}`},{key:"user",label:"User",class:"w-[35%] min-w-[150px]",render:(A,fe)=>({component:"user",image:fe.image,name:fe.name||"Anonymous",username:fe.username})},{key:"quantity",label:"Quantity",class:"w-[20%] min-w-[100px] font-mono",sortable:!1,render:A=>_r(A)},{key:"percentage",label:"%",class:"w-[12%] min-w-[70px]",sortable:!1,render:A=>({component:"badge",variant:"secondary",text:`${A.toFixed(1)}%`})},{key:"liquidationValue",label:"Value",class:"w-[23%] min-w-[90px] font-mono font-medium",sortable:!0,defaultSort:"desc",render:A=>pr(A)}]);var o=Ls(),ne=d(o);const W=F(()=>e(Z)&&e(Z).holders.length>3?"hover:bg-card/90 cursor-pointer transition-colors":"");v(ne,()=>Ge,(A,fe)=>{fe(A,{get class(){return`gap-2 ${e(W)??""}`},onclick:()=>e(Z)&&e(Z).holders.length>3&&m(K,!0),children:(Be,Ae)=>{var Ie=Cs(),Ke=d(Ie);v(Ke,()=>ot,(_e,be)=>{be(_e,{children:(Je,Qe)=>{var Fe=Ee(),ce=d(Fe);v(ce,()=>lt,(ke,u)=>{u(ke,{class:"flex items-center gap-2",children:(D,H)=>{j();var f=ae("Top Holders");t(D,f)},$$slots:{default:!0}})}),t(Je,Fe)},$$slots:{default:!0}})});var ze=r(Ke,2);v(ze,()=>et,(_e,be)=>{be(_e,{class:"relative",children:(Je,Qe)=>{var Fe=Ps(),ce=d(Fe);{var ke=f=>{Dr(f)},u=(f,$)=>{{var U=E=>{var w=gs(),Y=s(w);Gt(Y,{class:"text-muted-foreground mx-auto mb-2 h-8 w-8"}),j(2),a(w),t(E,w)},G=E=>{var w=ys();Bt(w,21,()=>e(Z).holders.slice(0,3),Mt,(Y,g)=>{var B=bs(),I=s(B),R=s(I);v(R,()=>rr,(z,ve)=>{ve(z,{class:"h-8 w-8 flex-shrink-0",children:(l,c)=>{var P=xs(),L=d(P);const b=F(()=>Vt(e(g).image)),C=F(()=>e(g).name||e(g).username);v(L,()=>ar,(ue,Ve)=>{Ve(ue,{get src(){return e(b)},get alt(){return e(C)}})});var oe=r(L,2);v(oe,()=>sr,(ue,Ve)=>{Ve(ue,{class:"text-xs",children:(nt,ut)=>{j();var Pe=ae();T(je=>p(Pe,je),[()=>(e(g).name||e(g).username).charAt(0)]),t(nt,Pe)},$$slots:{default:!0}})}),t(l,P)},$$slots:{default:!0}})});var Q=r(R,2),pe=s(Q),ye=s(pe,!0);a(pe);var De=r(pe,2),X=s(De);a(De),a(Q),a(I);var ee=r(I,2),$e=s(ee),tt=s($e);gt(tt,{variant:"secondary",class:"text-xs",children:(z,ve)=>{j();var l=ae();T(c=>p(l,`${c??""}%`),[()=>e(g).percentage.toFixed(1)]),t(z,l)},$$slots:{default:!0}}),a($e);var Me=r($e,2),we=s(Me),rt=s(we,!0);a(we);var _=r(we,2),se=s(_,!0);a(_),a(Me),a(ee),a(B),T((z,ve)=>{p(ye,e(g).name||"Anonymous"),p(X,`@${e(g).username??""}`),p(rt,z),p(se,ve)},[()=>_r(e(g).quantity),()=>pr(e(g).liquidationValue)]),t(Y,B)}),a(w),t(E,w)};J(f,E=>{!e(Z)||e(Z).holders.length===0?E(U):E(G,!1)},$)}};J(ce,f=>{e(Ce)?f(ke):f(u,!1)})}var D=r(ce,2);{var H=f=>{var $=ws();t(f,$)};J(D,f=>{e(Z)&&e(Z).holders.length>3&&f(H)})}t(Je,Fe)},$$slots:{default:!0}})}),t(Be,Ie)},$$slots:{default:!0}})});var Le=r(ne,2);v(Le,()=>kr,(A,fe)=>{fe(A,{get open(){return e(K)},set open(Be){m(K,Be,!0)},children:(Be,Ae)=>{var Ie=Ee(),Ke=d(Ie);v(Ke,()=>Cr,(ze,_e)=>{_e(ze,{class:"flex max-h-[90vh] w-full max-w-[calc(100%-2rem)] flex-col sm:max-w-[800px] md:max-w-2xl",children:(be,Je)=>{var Qe=Us(),Fe=d(Qe);v(Fe,()=>Sr,(H,f)=>{f(H,{class:"flex-shrink-0",children:($,U)=>{var G=Ss(),E=d(G);v(E,()=>Tr,(Y,g)=>{g(Y,{class:"flex items-center gap-2",children:(B,I)=>{var R=ks(),Q=d(R);Gt(Q,{class:"h-5 w-5"});var pe=r(Q);T(()=>{var ye;return p(pe,` Top Holders (*${((ye=e(Z))==null?void 0:ye.coinSymbol)??""})`)}),t(B,R)},$$slots:{default:!0}})});var w=r(E,2);v(w,()=>Ar,(Y,g)=>{g(Y,{children:(B,I)=>{j();var R=ae("This list is limited to the top 50 holders.");t(B,R)},$$slots:{default:!0}})}),t($,G)},$$slots:{default:!0}})});var ce=r(Fe,2),ke=s(ce);{var u=H=>{va(H,{class:"h-[600px] rounded-md border",children:(f,$)=>{var U=Ts(),G=s(U);ua(G,{get columns(){return e(y)},get data(){return e(Z).holders},onRowClick:E=>kt(`/user/${E.username}`),enableUserPreview:!0,emptyTitle:"No holders found",emptyDescription:"This coin doesn't have any holders yet."}),a(U),t(f,U)},$$slots:{default:!0}})},D=H=>{var f=As(),$=s(f),U=s($);Gt(U,{class:"text-muted-foreground mx-auto mb-4 h-12 w-12"}),j(4),a($),a(f),t(H,f)};J(ke,H=>{e(Z)&&e(Z).holders.length>0?H(u):H(D,!1)})}a(ce),t(be,Qe)},$$slots:{default:!0}})}),t(Be,Ie)},$$slots:{default:!0}})}),t(Oe,o),Kt()}var Fs=n("<!> <!>",1),Ds=n('<div class="flex h-96 items-center justify-center"><div class="text-center"><div class="text-muted-foreground mb-4 text-xl">Coin not found</div> <!></div></div>'),Ms=n("<!> <!>",1),Ns=n('<!> <span class="block truncate font-medium"> </span>',1),Es=n("<!> <!>",1),Is=n('<div class="text-muted-foreground flex flex-wrap items-center gap-2 text-sm"><span>Created by</span> <!></div>'),js=n("<!> ",1),Rs=n("<!> <!>",1),Os=n('<div class="flex items-center justify-between"><!> <div class="w-24"><!></div></div>'),Hs=n('<div class="flex h-full min-h-[500px] items-center justify-center"><p class="text-muted-foreground">No trading data available yet</p></div>'),Ys=n('<div class="h-full min-h-[500px] w-full"></div>'),zs=n("<!> <!>",1),Vs=n('<p class="text-muted-foreground text-sm"> </p>'),qs=n('<p class="text-muted-foreground text-sm"><!></p>'),Ks=n("<!> <!> <!>",1),Ws=n("<!> ",1),Js=n("<!> ",1),Qs=n('<div class="space-y-3"><!> <!></div>'),Xs=n('<div class="py-4 text-center"><p class="text-muted-foreground mb-3 text-sm">Sign in to start trading</p> <!></div>'),Zs=n("<!> <!>",1),Gs=n('<div class="space-y-4"><div><h4 class="mb-3 font-medium">Pool Composition</h4> <div class="space-y-2"><div class="flex justify-between"><span class="text-muted-foreground text-sm"> </span> <span class="font-mono text-sm"> </span></div> <div class="flex justify-between"><span class="text-muted-foreground text-sm">Base Currency:</span> <span class="font-mono text-sm"> </span></div></div></div> <div><h4 class="mb-3 font-medium">Pool Stats</h4> <div class="space-y-2"><div class="flex justify-between"><span class="text-muted-foreground text-sm">Total Liquidity:</span> <span class="font-mono text-sm"> </span></div> <div class="flex justify-between"><span class="text-muted-foreground text-sm">Current Price:</span> <span class="font-mono text-sm"> </span></div></div></div></div>'),eo=n("<!> Market Cap",1),to=n('<p class="text-xl font-bold"> </p>'),ro=n("<!> <!>",1),ao=n("<!> 24h Volume",1),so=n('<p class="text-xl font-bold"> </p>'),oo=n("<!> <!>",1),lo=n("<!> Circulating Supply",1),no=n('<p class="text-xl font-bold"> <span class="text-muted-foreground ml-1 text-xs"> </span></p>'),io=n("<!> <!>",1),co=n('<div class="flex items-center gap-2"><!> <!></div>'),vo=n("<!> <!>",1),uo=n('<header class="mb-8"><div class="mb-4 flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between"><div class="flex items-center gap-3 sm:gap-4"><!> <div class="min-w-0 flex-1"><h1 class="text-2xl font-bold sm:text-4xl"> </h1> <div class="mt-1 flex flex-wrap items-center gap-2"><!> <!> <!> <!></div></div></div> <div class="flex flex-col items-start gap-2 sm:items-end sm:text-right"><div class="relative"><p class="text-2xl font-bold sm:text-3xl"> </p></div> <div class="flex items-center gap-2"><!> <!></div></div></div> <!></header> <div class="grid gap-6"><div class="grid grid-cols-1 gap-6 lg:grid-cols-3"><div class="lg:col-span-2"><!></div> <div class="space-y-6 lg:col-span-1"><!> <!> <!></div></div> <div class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4"><!> <!> <!> <!></div> <!></div>',1),mo=n('<!> <!> <!> <div class="container mx-auto max-w-7xl p-6"><!></div>',1);function al(Oe,i){qt(i,!0);const[Ce,Z]=tr(),K=()=>zt(Ur,"$USER_DATA",Ce),N=()=>zt(ia,"$isConnectedStore",Ce);let y=F(()=>i.data.coinSymbol),o=xe(Lt(i.data.coin)),ne=xe(!1),W=xe(Lt(i.data.chartData)),Le=xe(Lt(i.data.volumeData)),A=xe(0),fe=xe(!1),Be=xe(!1),Ae=xe(Lt(i.data.timeframe||"1m")),Ie=0,Ke=xe(!1),ze=xe(null),_e=xe(null),be=xe(null);const Je=[{value:"1m",label:"1 minute"},{value:"5m",label:"5 minutes"},{value:"15m",label:"15 minutes"},{value:"1h",label:"1 hour"},{value:"4h",label:"4 hours"},{value:"1d",label:"1 day"}];Kr(async()=>{await Fe(),xt.setCoin(e(y).toUpperCase()),xt.subscribeToPriceUpdates(e(y).toUpperCase(),ke),m(ze,e(y),!0)}),Pt(()=>()=>{e(ze)&&xt.unsubscribeFromPriceUpdates(e(ze).toUpperCase())}),Pt(()=>{e(y)&&e(ze)&&e(y)!==e(ze)&&(m(ne,!0),m(o,null),m(W,[],!0),m(Le,[],!0),m(A,0),xt.unsubscribeFromPriceUpdates(e(ze).toUpperCase()),Qe().then(()=>{Fe(),xt.setCoin(e(y).toUpperCase()),xt.subscribeToPriceUpdates(e(y).toUpperCase(),ke),m(ze,e(y),!0)}))}),Pt(()=>{var l,c;if((l=e(o))!=null&&l.isLocked&&((c=e(o))!=null&&c.tradingUnlocksAt)){const P=new Date(e(o).tradingUnlocksAt).getTime(),L=()=>{const b=Date.now(),C=Math.max(0,Math.ceil((P-b)/1e3));m(_e,C,!0),C===0&&e(be)&&(clearInterval(e(be)),m(be,null),e(o)&&m(o,{...e(o),isLocked:!1},!0))};L(),m(be,setInterval(L,1e3),!0)}else m(_e,null),e(be)&&(clearInterval(e(be)),m(be,null));return()=>{e(be)&&clearInterval(e(be))}});async function Qe(){try{m(ne,!0);const l=await fetch(`/api/coin/${e(y)}?timeframe=${e(Ae)}`);if(!l.ok){Ct.error(l.status===404?"Coin not found":"Failed to load coin data");return}const c=await l.json();m(o,c.coin,!0),m(W,c.candlestickData||[],!0),m(Le,c.volumeData||[],!0)}catch(l){console.error("Failed to fetch coin data:",l),Ct.error("Failed to load coin data")}finally{m(ne,!1)}}async function Fe(){if(K())try{const l=await fetch("/api/portfolio/total");if(l.ok){const P=(await l.json()).coinHoldings.find(L=>L.symbol===e(y).toUpperCase());m(A,P?P.quantity:0,!0)}}catch(l){console.error("Failed to load user holding:",l)}}async function ce(){await Promise.all([Qe(),Fe(),oa()])}function ke(l){if(e(o)&&l.coinSymbol===e(y).toUpperCase()){const c=Date.now();if(c-Ie<1e3)return;Ie=c,m(o,{...e(o),currentPrice:l.currentPrice,marketCap:l.marketCap,change24h:l.change24h,volume24h:l.volume24h,...l.poolCoinAmount!==void 0&&{poolCoinAmount:l.poolCoinAmount},...l.poolBaseCurrencyAmount!==void 0&&{poolBaseCurrencyAmount:l.poolBaseCurrencyAmount}},!0),u(l.currentPrice)}}function u(l){if(!U||!$||e(W).length===0)return;const c=Jr(e(Ae)),P=Math.floor(Date.now()/1e3),L=Math.floor(P/c)*c,b=Qr(L),C=e(W)[e(W).length-1];if(C&&C.time===b){const oe={time:b,open:C.open,high:Math.max(C.high,l),low:Math.min(C.low,l),close:l};U.update(oe),e(W)[e(W).length-1]=oe}else if(b>((C==null?void 0:C.time)||0)){const oe={time:b,open:l,high:l,low:l,close:l};U.update(oe),e(W).push(oe)}}async function D(l){m(Ae,l,!0),m(ne,!0),$&&($.remove(),$=null),await Qe(),m(ne,!1)}let H=F(()=>{var l;return((l=Je.find(c=>c.value===e(Ae)))==null?void 0:l.label)||"1 minute"}),f=xe(void 0),$=null,U=null,G=null;Pt(()=>{if($&&e(W).length>0&&($.remove(),$=null),e(f)&&e(W).length>0){$=ma(e(f),{layout:{textColor:"#666666",background:{type:fa.Solid,color:"transparent"},attributionLogo:!1,panes:{separatorColor:"#2B2B43",separatorHoverColor:"rgba(107, 114, 142, 0.3)",enableResize:!0}},grid:{vertLines:{color:"#2B2B43"},horzLines:{color:"#2B2B43"}},rightPriceScale:{borderVisible:!1,scaleMargins:{top:.1,bottom:.1},alignLabels:!0,entireTextOnly:!1},timeScale:{borderVisible:!1,timeVisible:!0,barSpacing:20,rightOffset:5,minBarSpacing:8},crosshair:{mode:1,vertLine:{color:"#758696",width:1,style:2,visible:!0,labelVisible:!0},horzLine:{color:"#758696",width:1,style:2,visible:!0,labelVisible:!0}}}),U=$.addSeries(_a,{upColor:"#26a69a",downColor:"#ef5350",borderVisible:!0,borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickUpColor:"#26a69a",wickDownColor:"#ef5350",priceFormat:{type:"price",precision:8,minMove:1e-8}}),G=$.addSeries(pa,{priceFormat:{type:"volume"},priceScaleId:"volume"},1);const l=e(W).map(L=>{if(L.open===L.close){const b=L.open,C=b*.001;return{...L,high:Math.max(L.high,b+C),low:Math.min(L.low,b-C)}}return L});U.setData(l),G.setData(g(e(W),e(Le)));const c=$.panes()[1];c&&c.setHeight(100),$.timeScale().fitContent();const P=()=>{var L;return $==null?void 0:$.applyOptions({width:(L=e(f))==null?void 0:L.clientWidth})};return window.addEventListener("resize",P),P(),U.priceScale().applyOptions({borderColor:"#71649C"}),G.priceScale().applyOptions({borderColor:"#71649C"}),$.timeScale().applyOptions({borderColor:"#71649C"}),()=>{window.removeEventListener("resize",P),$&&($.remove(),$=null)}}});function E(l){return l<1e-6?l.toFixed(8):l<.01?l.toFixed(6):l<1?l.toFixed(4):l.toFixed(2)}function w(l){const c=Number(l);return isNaN(c)?"$0.00":c>=1e9?`$${(c/1e9).toFixed(2)}B`:c>=1e6?`$${(c/1e6).toFixed(2)}M`:c>=1e3?`$${(c/1e3).toFixed(2)}K`:`$${c.toFixed(2)}`}function Y(l){const c=Number(l);return isNaN(c)?"0":c>=1e9?`${(c/1e9).toFixed(2)}B`:c>=1e6?`${(c/1e6).toFixed(2)}M`:c>=1e3?`${(c/1e3).toFixed(2)}K`:c.toLocaleString()}function g(l,c){return l.map((P,L)=>{const b=c.find(oe=>oe.time===P.time),C=b?b.volume:0;return{time:P.time,value:C,color:P.close>=P.open?"#26a69a":"#ef5350"}})}function B(l){const c=Math.floor(l/60),P=l%60;return`${c}:${P.toString().padStart(2,"0")}`}let I=F(()=>e(o)&&K()&&e(o).creatorId===Number(K().id)),R=F(()=>{var l;return((l=e(o))==null?void 0:l.isLocked)&&e(_e)!==null&&e(_e)>0}),Q=F(()=>!e(R)||e(I));var pe=mo(),ye=d(pe);const De=F(()=>e(o)?`${e(o).name} (*${e(o).symbol}) - Rugplay`:`Loading ${e(y).toUpperCase()} - Rugplay`),X=F(()=>e(o)?`Trade ${e(o).name} (*${e(o).symbol}) in the Rugplay simulation game. Current price: $${E(e(o).currentPrice)}, Market cap: ${w(e(o).marketCap)}, 24h change: ${e(o).change24h>=0?"+":""}${e(o).change24h.toFixed(2)}%.`:`Virtual cryptocurrency trading page for ${e(y).toUpperCase()} in the Rugplay simulation game.`),ee=F(()=>e(o)?`${e(o).name} cryptocurrency game, *${e(o).symbol} virtual trading, ${e(o).symbol} price simulation, cryptocurrency trading game, virtual coin ${e(o).symbol}`:`${e(y)} virtual cryptocurrency, crypto trading simulation, virtual coin trading`),$e=F(()=>{var l;return(l=e(o))!=null&&l.icon?Vt(e(o).icon):"/apple-touch-icon.png"}),tt=F(()=>e(o)?`${e(o).name} (${e(o).symbol}) logo`:`${e(y)} cryptocurrency logo`);ha(ye,{get title(){return e(De)},get description(){return e(X)},get keywords(){return e(ee)},get image(){return e($e)},get imageAlt(){return e(tt)},twitterCard:"summary"});var Me=r(ye,2);Lr(Me,{get open(){return e(Ke)},set open(l){m(Ke,l,!0)}});var we=r(Me,2);{var rt=l=>{var c=Fs(),P=d(c);hr(P,{type:"BUY",get coin(){return e(o)},onSuccess:ce,get open(){return e(fe)},set open(b){m(fe,b,!0)}});var L=r(P,2);hr(L,{type:"SELL",get coin(){return e(o)},get userHolding(){return e(A)},onSuccess:ce,get open(){return e(Be)},set open(b){m(Be,b,!0)}}),t(l,c)};J(we,l=>{e(o)&&l(rt)})}var _=r(we,2),se=s(_);{var z=l=>{hs(l)},ve=(l,c)=>{{var P=b=>{var C=Ds(),oe=s(C),ue=r(s(oe),2);pt(ue,{onclick:()=>kt("/"),children:(Ve,nt)=>{j();var ut=ae("Go Home");t(Ve,ut)},$$slots:{default:!0}}),a(oe),a(C),t(b,C)},L=b=>{var C=uo(),oe=d(C),ue=s(oe),Ve=s(ue),nt=s(Ve);$a(nt,{get icon(){return e(o).icon},get symbol(){return e(o).symbol},get name(){return e(o).name},size:12,class:"border sm:size-16"});var ut=r(nt,2),Pe=s(ut),je=s(Pe,!0);a(Pe);var it=r(Pe,2),bt=s(it);gt(bt,{variant:"outline",class:"text-sm sm:text-lg",children:(k,me)=>{j();var he=ae();T(()=>p(he,`*${e(o).symbol??""}`)),t(k,he)},$$slots:{default:!0}});var Nt=r(bt,2);{var Et=k=>{gt(k,{variant:"outline",class:"animate-pulse border-green-500 text-xs text-green-500",children:(me,he)=>{j();var qe=ae("â— LIVE");t(me,qe)},$$slots:{default:!0}})};J(Nt,k=>{N()&&k(Et)})}var It=r(Nt,2);{var Wt=k=>{gt(k,{variant:"secondary",class:"text-xs",children:(me,he)=>{j();var qe=ae();T(ge=>p(qe,`ðŸ”’ LOCKED ${ge??""}`),[()=>e(_e)!==null?B(e(_e)):""]),t(me,qe)},$$slots:{default:!0}})};J(It,k=>{e(R)&&k(Wt)})}var Xe=r(It,2);{var dt=k=>{gt(k,{variant:"destructive",children:(me,he)=>{j();var qe=ae("Delisted");t(me,qe)},$$slots:{default:!0}})};J(Xe,k=>{e(o).isListed||k(dt)})}a(it),a(ut),a(Ve);var Ze=r(Ve,2),ft=s(Ze),_t=s(ft),$t=s(_t);a(_t),a(ft);var yt=r(ft,2),ct=s(yt);{var st=k=>{Ht(k,{class:"h-4 w-4 text-green-500"})},mt=k=>{Yt(k,{class:"h-4 w-4 text-red-500"})};J(ct,k=>{e(o).change24h>=0?k(st):k(mt,!1)})}var Ft=r(ct,2);const St=F(()=>e(o).change24h>=0?"success":"destructive");gt(Ft,{get variant(){return e(St)},class:"text-sm",children:(k,me)=>{j();var he=ae();T(qe=>p(he,`${e(o).change24h>=0?"+":""}${qe??""}%`),[()=>Number(e(o).change24h).toFixed(2)]),t(k,he)},$$slots:{default:!0}}),a(yt),a(Ze),a(ue);var Tt=r(ue,2);{var At=k=>{var me=Is(),he=r(s(me),2);v(he,()=>br,(qe,ge)=>{ge(qe,{children:(Ue,at)=>{var te=Es(),re=d(te);v(re,()=>yr,(Re,h)=>{h(Re,{class:"flex min-w-0 max-w-[200px] cursor-pointer items-center gap-1 rounded-sm underline-offset-4 hover:underline focus-visible:outline-2 focus-visible:outline-offset-8 sm:max-w-[250px]",onclick:()=>kt(`/user/${e(o).creatorUsername}`),children:(O,V)=>{var de=Ns(),M=d(de);v(M,()=>rr,(le,Se)=>{Se(le,{class:"h-4 w-4 flex-shrink-0",children:(Ne,We)=>{var He=Ms(),Te=d(He);const Ye=F(()=>Vt(e(o).creatorImage));v(Te,()=>ar,(vt,wt)=>{wt(vt,{get src(){return e(Ye)},get alt(){return e(o).creatorName}})});var ht=r(Te,2);v(ht,()=>sr,(vt,wt)=>{wt(vt,{children:(Dt,jt)=>{j();var Ut=ae();T(Rt=>p(Ut,Rt),[()=>e(o).creatorName.charAt(0)]),t(Dt,Ut)},$$slots:{default:!0}})}),t(Ne,He)},$$slots:{default:!0}})});var q=r(M,2),x=s(q);a(q),T(()=>p(x,`${e(o).creatorName??""} (@${e(o).creatorUsername??""})`)),t(O,de)},$$slots:{default:!0}})});var ie=r(re,2);v(ie,()=>wr,(Re,h)=>{h(Re,{class:"w-80",side:"bottom",sideOffset:3,children:(O,V)=>{Pr(O,{get userId(){return e(o).creatorId}})},$$slots:{default:!0}})}),t(Ue,te)},$$slots:{default:!0}})}),a(me),t(k,me)};J(Tt,k=>{e(o).creatorName&&k(At)})}a(oe);var or=r(oe,2),Jt=s(or),Qt=s(Jt),Mr=s(Qt);v(Mr,()=>Ge,(k,me)=>{me(k,{class:"flex h-full flex-col",children:(he,qe)=>{var ge=zs(),Ue=d(ge);v(Ue,()=>ot,(te,re)=>{re(te,{class:"pb-4",children:(ie,Re)=>{var h=Os(),O=s(h);v(O,()=>lt,(M,q)=>{q(M,{class:"flex items-center gap-2",children:(x,le)=>{var Se=js(),Ne=d(Se);$r(Ne,{class:"h-5 w-5"});var We=r(Ne);T(()=>p(We,` Price Chart (${e(Ae)??""})`)),t(x,Se)},$$slots:{default:!0}})});var V=r(O,2),de=s(V);v(de,()=>Xr,(M,q)=>{q(M,{type:"single",onValueChange:D,get disabled(){return e(ne)},get value(){return e(Ae)},set value(x){m(Ae,x,!0)},children:(x,le)=>{var Se=Rs(),Ne=d(Se);v(Ne,()=>Zr,(He,Te)=>{Te(He,{class:"w-full",children:(Ye,ht)=>{j();var vt=ae();T(()=>p(vt,e(H))),t(Ye,vt)},$$slots:{default:!0}})});var We=r(Ne,2);v(We,()=>Gr,(He,Te)=>{Te(He,{children:(Ye,ht)=>{var vt=Ee(),wt=d(vt);v(wt,()=>ea,(Dt,jt)=>{jt(Dt,{children:(Ut,Rt)=>{var Ot=Ee(),jr=d(Ot);Bt(jr,17,()=>Je,Mt,(Rr,Zt)=>{var ur=Ee(),Or=d(ur);v(Or,()=>ta,(Hr,Yr)=>{Yr(Hr,{get value(){return e(Zt).value},get label(){return e(Zt).label},children:(zr,fo)=>{j();var mr=ae();T(()=>p(mr,e(Zt).label)),t(zr,mr)},$$slots:{default:!0}})}),t(Rr,ur)}),t(Ut,Ot)},$$slots:{default:!0}})}),t(Ye,vt)},$$slots:{default:!0}})}),t(x,Se)},$$slots:{default:!0}})}),a(V),a(h),t(ie,h)},$$slots:{default:!0}})});var at=r(Ue,2);v(at,()=>et,(te,re)=>{re(te,{class:"flex-1 pt-0",children:(ie,Re)=>{var h=Ee(),O=d(h);{var V=M=>{var q=Hs();t(M,q)},de=M=>{var q=Ys();qr(q,x=>m(f,x),()=>e(f)),t(M,q)};J(O,M=>{e(W).length===0?M(V):M(de,!1)})}t(ie,h)},$$slots:{default:!0}})}),t(he,ge)},$$slots:{default:!0}})}),a(Qt);var lr=r(Qt,2),nr=s(lr);v(nr,()=>Ge,(k,me)=>{me(k,{children:(he,qe)=>{var ge=Zs(),Ue=d(ge);v(Ue,()=>ot,(te,re)=>{re(te,{children:(ie,Re)=>{var h=Ks(),O=d(h);v(O,()=>lt,(x,le)=>{le(x,{children:(Se,Ne)=>{j();var We=ae();T(()=>p(We,`Trade ${e(o).symbol??""}`)),t(Se,We)},$$slots:{default:!0}})});var V=r(O,2);{var de=x=>{var le=Vs(),Se=s(le);a(le),T(Ne=>p(Se,`You own: ${Ne??""}
									${e(o).symbol??""}`),[()=>Y(e(A))]),t(x,le)};J(V,x=>{e(A)>0&&x(de)})}var M=r(V,2);{var q=x=>{var le=qs(),Se=s(le);{var Ne=He=>{var Te=ae();T(Ye=>p(Te,`ðŸ”’ Creator-only period: ${Ye??""} remaining`),[()=>e(_e)!==null?B(e(_e)):""]),t(He,Te)},We=He=>{var Te=ae();T(Ye=>p(Te,`ðŸ”’ Trading unlocks in: ${Ye??""}`),[()=>e(_e)!==null?B(e(_e)):""]),t(He,Te)};J(Se,He=>{e(I)?He(Ne):He(We,!1)})}a(le),t(x,le)};J(M,x=>{e(R)&&x(q)})}t(ie,h)},$$slots:{default:!0}})});var at=r(Ue,2);v(at,()=>et,(te,re)=>{re(te,{children:(ie,Re)=>{var h=Ee(),O=d(h);{var V=M=>{var q=Qs(),x=s(q);const le=F(()=>!e(o).isListed||!e(Q));pt(x,{class:"w-full",variant:"default",size:"lg",onclick:()=>m(fe,!0),get disabled(){return e(le)},children:(We,He)=>{var Te=Ws(),Ye=d(Te);Ht(Ye,{class:"h-4 w-4"});var ht=r(Ye);T(()=>p(ht,` Buy ${e(o).symbol??""}`)),t(We,Te)},$$slots:{default:!0}});var Se=r(x,2);const Ne=F(()=>!e(o).isListed||e(A)<=0||!e(Q));pt(Se,{class:"w-full",variant:"outline",size:"lg",onclick:()=>m(Be,!0),get disabled(){return e(Ne)},children:(We,He)=>{var Te=Js(),Ye=d(Te);Yt(Ye,{class:"h-4 w-4"});var ht=r(Ye);T(()=>p(ht,` Sell ${e(o).symbol??""}`)),t(We,Te)},$$slots:{default:!0}}),a(q),t(M,q)},de=M=>{var q=Xs(),x=r(s(q),2);pt(x,{onclick:()=>m(Ke,!0),children:(le,Se)=>{j();var Ne=ae("Sign In");t(le,Ne)},$$slots:{default:!0}}),a(q),t(M,q)};J(O,M=>{K()?M(V):M(de,!1)})}t(ie,h)},$$slots:{default:!0}})}),t(he,ge)},$$slots:{default:!0}})});var ir=r(nr,2);v(ir,()=>Ge,(k,me)=>{me(k,{children:(he,qe)=>{var ge=Ee(),Ue=d(ge);v(Ue,()=>et,(at,te)=>{te(at,{children:(re,ie)=>{var Re=Gs(),h=s(Re),O=r(s(h),2),V=s(O),de=s(V),M=s(de);a(de);var q=r(de,2),x=s(q,!0);a(q),a(V);var le=r(V,2),Se=r(s(le),2),Ne=s(Se);a(Se),a(le),a(O),a(h);var We=r(h,2),He=r(s(We),2),Te=s(He),Ye=r(s(Te),2),ht=s(Ye);a(Ye),a(Te);var vt=r(Te,2),wt=r(s(vt),2),Dt=s(wt);a(wt),a(vt),a(He),a(We),a(Re),T((jt,Ut,Rt,Ot)=>{p(M,`${e(o).symbol??""}:`),p(x,jt),p(Ne,`$${Ut??""}`),p(ht,`$${Rt??""}`),p(Dt,`$${Ot??""}`)},[()=>Y(e(o).poolCoinAmount),()=>Number(e(o).poolBaseCurrencyAmount).toLocaleString(),()=>(Number(e(o).poolBaseCurrencyAmount)*2).toLocaleString(),()=>E(e(o).currentPrice)]),t(re,Re)},$$slots:{default:!0}})}),t(he,ge)},$$slots:{default:!0}})});var Nr=r(ir,2);Bs(Nr,{get coinSymbol(){return e(o).symbol}}),a(lr),a(Jt);var Xt=r(Jt,2),dr=s(Xt);v(dr,()=>Ge,(k,me)=>{me(k,{class:"gap-1",children:(he,qe)=>{var ge=ro(),Ue=d(ge);v(Ue,()=>ot,(te,re)=>{re(te,{children:(ie,Re)=>{var h=Ee(),O=d(h);v(O,()=>lt,(V,de)=>{de(V,{class:"flex items-center gap-2 text-sm font-medium",children:(M,q)=>{var x=eo(),le=d(x);ca(le,{class:"h-4 w-4"}),j(),t(M,x)},$$slots:{default:!0}})}),t(ie,h)},$$slots:{default:!0}})});var at=r(Ue,2);v(at,()=>et,(te,re)=>{re(te,{children:(ie,Re)=>{var h=to(),O=s(h,!0);a(h),T(V=>p(O,V),[()=>w(e(o).marketCap)]),t(ie,h)},$$slots:{default:!0}})}),t(he,ge)},$$slots:{default:!0}})});var cr=r(dr,2);v(cr,()=>Ge,(k,me)=>{me(k,{class:"gap-1",children:(he,qe)=>{var ge=oo(),Ue=d(ge);v(Ue,()=>ot,(te,re)=>{re(te,{children:(ie,Re)=>{var h=Ee(),O=d(h);v(O,()=>lt,(V,de)=>{de(V,{class:"flex items-center gap-2 text-sm font-medium",children:(M,q)=>{var x=ao(),le=d(x);$r(le,{class:"h-4 w-4"}),j(),t(M,x)},$$slots:{default:!0}})}),t(ie,h)},$$slots:{default:!0}})});var at=r(Ue,2);v(at,()=>et,(te,re)=>{re(te,{children:(ie,Re)=>{var h=so(),O=s(h,!0);a(h),T(V=>p(O,V),[()=>w(e(o).volume24h)]),t(ie,h)},$$slots:{default:!0}})}),t(he,ge)},$$slots:{default:!0}})});var vr=r(cr,2);v(vr,()=>Ge,(k,me)=>{me(k,{class:"gap-1",children:(he,qe)=>{var ge=io(),Ue=d(ge);v(Ue,()=>ot,(te,re)=>{re(te,{children:(ie,Re)=>{var h=Ee(),O=d(h);v(O,()=>lt,(V,de)=>{de(V,{class:"flex items-center gap-2 text-sm font-medium",children:(M,q)=>{var x=lo(),le=d(x);ga(le,{class:"h-4 w-4"}),j(),t(M,x)},$$slots:{default:!0}})}),t(ie,h)},$$slots:{default:!0}})});var at=r(Ue,2);v(at,()=>et,(te,re)=>{re(te,{children:(ie,Re)=>{var h=no(),O=s(h,!0),V=r(O),de=s(V);a(V),a(h),T((M,q)=>{p(O,M),p(de,`of ${q??""} total`)},[()=>Y(e(o).circulatingSupply),()=>Y(e(o).initialSupply)]),t(ie,h)},$$slots:{default:!0}})}),t(he,ge)},$$slots:{default:!0}})});var Er=r(vr,2);v(Er,()=>Ge,(k,me)=>{me(k,{class:"gap-1",children:(he,qe)=>{var ge=vo(),Ue=d(ge);v(Ue,()=>ot,(te,re)=>{re(te,{children:(ie,Re)=>{var h=Ee(),O=d(h);v(O,()=>lt,(V,de)=>{de(V,{class:"text-sm font-medium",children:(M,q)=>{j();var x=ae("24h Change");t(M,x)},$$slots:{default:!0}})}),t(ie,h)},$$slots:{default:!0}})});var at=r(Ue,2);v(at,()=>et,(te,re)=>{re(te,{children:(ie,Re)=>{var h=co(),O=s(h);{var V=x=>{Ht(x,{class:"h-4 w-4 text-green-500"})},de=x=>{Yt(x,{class:"h-4 w-4 text-red-500"})};J(O,x=>{e(o).change24h>=0?x(V):x(de,!1)})}var M=r(O,2);const q=F(()=>e(o).change24h>=0?"success":"destructive");gt(M,{get variant(){return e(q)},class:"text-sm",children:(x,le)=>{j();var Se=ae();T(Ne=>p(Se,`${e(o).change24h>=0?"+":""}${Ne??""}%`),[()=>Number(e(o).change24h).toFixed(2)]),t(x,Se)},$$slots:{default:!0}}),a(h),t(ie,h)},$$slots:{default:!0}})}),t(he,ge)},$$slots:{default:!0}})}),a(Xt);var Ir=r(Xt,2);es(Ir,{get coinSymbol(){return e(y)}}),a(or),T(k=>{p(je,e(o).name),p($t,`$${k??""}`)},[()=>E(e(o).currentPrice)]),t(b,C)};J(l,b=>{e(o)?b(L,!1):b(P)},c)}};J(se,l=>{e(ne)?l(z):l(ve,!1)})}a(_),t(Oe,pe),Kt(),Z()}export{al as component};
