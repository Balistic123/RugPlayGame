{"version":3,"file":"_server.ts-Dq8S0VNr.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/keys/_server.ts.js"],"sourcesContent":["import { e as error, j as json } from \"../../../../chunks/index.js\";\nimport { a as auth } from \"../../../../chunks/auth.js\";\nconst GET = async (event) => {\n  const session = await auth.api.getSession({\n    headers: event.request.headers\n  });\n  if (!session?.user) {\n    throw error(401, \"Not authenticated\");\n  }\n  const keys = await auth.api.listApiKeys({\n    headers: event.request.headers\n  });\n  return json(keys);\n};\nconst POST = async (event) => {\n  const session = await auth.api.getSession({\n    headers: event.request.headers\n  });\n  if (!session?.user) {\n    throw error(401, \"Not authenticated\");\n  }\n  const existingKeys = await auth.api.listApiKeys({\n    headers: event.request.headers\n  });\n  if (existingKeys.length > 0) {\n    throw error(400, \"You can only have one API key at a time\");\n  }\n  const apiKey = await auth.api.createApiKey({\n    body: {\n      name: \"API Key\",\n      remaining: 2e3,\n      permissions: {\n        api: [\"read\"]\n      },\n      userId: session.user.id\n    },\n    headers: event.request.headers\n  });\n  return json(apiKey);\n};\nexport {\n  GET,\n  POST\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAEK,MAAC,GAAG,GAAG,OAAO,KAAK,KAAK;AAC7B,EAAE,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC;AAC5C,IAAI,OAAO,EAAE,KAAK,CAAC,OAAO,CAAC;AAC3B,GAAG,CAAC;AACJ,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,EAAE;AACtB,IAAI,MAAM,KAAK,CAAC,GAAG,EAAE,mBAAmB,CAAC;AACzC;AACA,EAAE,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;AAC1C,IAAI,OAAO,EAAE,KAAK,CAAC,OAAO,CAAC;AAC3B,GAAG,CAAC;AACJ,EAAE,OAAO,IAAI,CAAC,IAAI,CAAC;AACnB;AACK,MAAC,IAAI,GAAG,OAAO,KAAK,KAAK;AAC9B,EAAE,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC;AAC5C,IAAI,OAAO,EAAE,KAAK,CAAC,OAAO,CAAC;AAC3B,GAAG,CAAC;AACJ,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,EAAE;AACtB,IAAI,MAAM,KAAK,CAAC,GAAG,EAAE,mBAAmB,CAAC;AACzC;AACA,EAAE,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;AAClD,IAAI,OAAO,EAAE,KAAK,CAAC,OAAO,CAAC;AAC3B,GAAG,CAAC;AACJ,EAAE,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;AAC/B,IAAI,MAAM,KAAK,CAAC,GAAG,EAAE,yCAAyC,CAAC;AAC/D;AACA,EAAE,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC;AAC7C,IAAI,IAAI,EAAE;AACV,MAAM,IAAI,EAAE,SAAS;AACrB,MAAM,SAAS,EAAE,GAAG;AACpB,MAAM,WAAW,EAAE;AACnB,QAAQ,GAAG,EAAE,CAAC,MAAM;AACpB,OAAO;AACP,MAAM,MAAM,EAAE,OAAO,CAAC,IAAI,CAAC;AAC3B,KAAK;AACL,IAAI,OAAO,EAAE,KAAK,CAAC,OAAO,CAAC;AAC3B,GAAG,CAAC;AACJ,EAAE,OAAO,IAAI,CAAC,MAAM,CAAC;AACrB;;;;"}