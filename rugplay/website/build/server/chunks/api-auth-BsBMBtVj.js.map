{"version":3,"file":"api-auth-BsBMBtVj.js","sources":["../../../.svelte-kit/adapter-node/chunks/api-auth.js"],"sourcesContent":["import { a as auth } from \"./auth.js\";\nimport { e as error } from \"./index.js\";\nasync function verifyApiKeyAndGetUser(request) {\n  const authHeader = request.headers.get(\"Authorization\");\n  if (!authHeader?.startsWith(\"Bearer \")) {\n    throw error(401, \"API key required. Use Authorization: Bearer <api-key>\");\n  }\n  const apiKeyStr = authHeader.substring(7);\n  const { valid, error: verifyError, key } = await auth.api.verifyApiKey({\n    body: { key: apiKeyStr }\n  });\n  if (verifyError || !valid || !key) {\n    throw error(401, \"Invalid API key\");\n  }\n  return key.userId;\n}\nexport {\n  verifyApiKeyAndGetUser as v\n};\n"],"names":[],"mappings":";;;AAEA,eAAe,sBAAsB,CAAC,OAAO,EAAE;AAC/C,EAAE,MAAM,UAAU,GAAG,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC;AACzD,EAAE,IAAI,CAAC,UAAU,EAAE,UAAU,CAAC,SAAS,CAAC,EAAE;AAC1C,IAAI,MAAM,KAAK,CAAC,GAAG,EAAE,uDAAuD,CAAC;AAC7E;AACA,EAAE,MAAM,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC;AAC3C,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,WAAW,EAAE,GAAG,EAAE,GAAG,MAAM,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC;AACzE,IAAI,IAAI,EAAE,EAAE,GAAG,EAAE,SAAS;AAC1B,GAAG,CAAC;AACJ,EAAE,IAAI,WAAW,IAAI,CAAC,KAAK,IAAI,CAAC,GAAG,EAAE;AACrC,IAAI,MAAM,KAAK,CAAC,GAAG,EAAE,iBAAiB,CAAC;AACvC;AACA,EAAE,OAAO,GAAG,CAAC,MAAM;AACnB;;;;"}