{"version":3,"file":"websocket-DCXra_5K.js","sources":["../../../.svelte-kit/adapter-node/chunks/websocket.js"],"sourcesContent":["import { w as writable } from \"./index2.js\";\nimport \"./notifications.js\";\nimport { U as USER_DATA } from \"./user-data.js\";\nimport \"clsx\";\nimport \"./Toaster.svelte_svelte_type_style_lang.js\";\nimport \"./client.js\";\nlet socket = null;\nlet activeCoin = \"@global\";\nconst liveTradesStore = writable([]);\nconst allTradesStore = writable([]);\nconst isConnectedStore = writable(false);\nconst isLoadingTrades = writable(false);\nconst commentSubscriptions = /* @__PURE__ */ new Map();\nconst priceUpdateSubscriptions = /* @__PURE__ */ new Map();\nasync function loadInitialTrades(mode = \"preview\") {\n  return;\n}\nfunction isSocketConnected() {\n  return socket?.readyState === WebSocket.OPEN;\n}\nfunction sendMessage(message) {\n  if (isSocketConnected()) {\n    socket.send(JSON.stringify(message));\n  }\n}\nfunction setCoin(coinSymbol) {\n  if (activeCoin !== coinSymbol && activeCoin !== \"@global\") {\n    unsubscribeFromPriceUpdates(activeCoin);\n  }\n  activeCoin = coinSymbol;\n  sendMessage({ type: \"set_coin\", coinSymbol });\n}\nfunction disconnect() {\n  isConnectedStore.set(false);\n}\nfunction subscribeToComments(coinSymbol, callback) {\n  commentSubscriptions.set(coinSymbol, callback);\n}\nfunction unsubscribeFromComments(coinSymbol) {\n  commentSubscriptions.delete(coinSymbol);\n}\nfunction subscribeToPriceUpdates(coinSymbol, callback) {\n  priceUpdateSubscriptions.set(coinSymbol, callback);\n}\nfunction unsubscribeFromPriceUpdates(coinSymbol) {\n  priceUpdateSubscriptions.delete(coinSymbol);\n}\nclass WebSocketController {\n  connect() {\n  }\n  disconnect() {\n    disconnect();\n  }\n  setCoin(coinSymbol) {\n    setCoin(coinSymbol);\n  }\n  subscribeToComments(coinSymbol, callback) {\n    subscribeToComments(coinSymbol, callback);\n  }\n  unsubscribeFromComments(coinSymbol) {\n    unsubscribeFromComments(coinSymbol);\n  }\n  subscribeToPriceUpdates(coinSymbol, callback) {\n    subscribeToPriceUpdates(coinSymbol, callback);\n  }\n  unsubscribeFromPriceUpdates(coinSymbol) {\n    unsubscribeFromPriceUpdates(coinSymbol);\n  }\n  loadInitialTrades(mode = \"preview\") {\n    loadInitialTrades(mode);\n  }\n  setUser(userId) {\n  }\n}\nif (typeof window !== \"undefined\") {\n  USER_DATA.subscribe((user) => {\n    if (user?.id) {\n      websocketController.setUser(user.id.toString());\n    }\n  });\n}\nconst websocketController = new WebSocketController();\nexport {\n  isConnectedStore as a,\n  allTradesStore as b,\n  isLoadingTrades as i,\n  liveTradesStore as l\n};\n"],"names":[],"mappings":";;;;;;AAMA,IAAI,MAAM,GAAG,IAAI;AACjB,IAAI,UAAU,GAAG,SAAS;AACrB,MAAC,eAAe,GAAG,QAAQ,CAAC,EAAE;AAC9B,MAAC,cAAc,GAAG,QAAQ,CAAC,EAAE;AAC7B,MAAC,gBAAgB,GAAG,QAAQ,CAAC,KAAK;AAClC,MAAC,eAAe,GAAG,QAAQ,CAAC,KAAK;AACtC,MAAM,oBAAoB,mBAAmB,IAAI,GAAG,EAAE;AACtD,MAAM,wBAAwB,mBAAmB,IAAI,GAAG,EAAE;AAC1D,eAAe,iBAAiB,CAAC,IAAI,GAAG,SAAS,EAAE;AACnD,EAAE;AACF;AACA,SAAS,iBAAiB,GAAG;AAC7B,EAAE,OAAO,MAAM,EAAE,UAAU,KAAK,SAAS,CAAC,IAAI;AAC9C;AACA,SAAS,WAAW,CAAC,OAAO,EAAE;AAC9B,EAAE,IAAI,iBAAiB,EAAE,EAAE;AAC3B,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;AACxC;AACA;AACA,SAAS,OAAO,CAAC,UAAU,EAAE;AAC7B,EAAE,IAAI,UAAU,KAAK,UAAU,IAAI,UAAU,KAAK,SAAS,EAAE;AAC7D,IAAI,2BAA2B,CAAC,UAAU,CAAC;AAC3C;AACA,EAAE,UAAU,GAAG,UAAU;AACzB,EAAE,WAAW,CAAC,EAAE,IAAI,EAAE,UAAU,EAAE,UAAU,EAAE,CAAC;AAC/C;AACA,SAAS,UAAU,GAAG;AACtB,EAAE,gBAAgB,CAAC,GAAG,CAAC,KAAK,CAAC;AAC7B;AACA,SAAS,mBAAmB,CAAC,UAAU,EAAE,QAAQ,EAAE;AACnD,EAAE,oBAAoB,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC;AAChD;AACA,SAAS,uBAAuB,CAAC,UAAU,EAAE;AAC7C,EAAE,oBAAoB,CAAC,MAAM,CAAC,UAAU,CAAC;AACzC;AACA,SAAS,uBAAuB,CAAC,UAAU,EAAE,QAAQ,EAAE;AACvD,EAAE,wBAAwB,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC;AACpD;AACA,SAAS,2BAA2B,CAAC,UAAU,EAAE;AACjD,EAAE,wBAAwB,CAAC,MAAM,CAAC,UAAU,CAAC;AAC7C;AACA,MAAM,mBAAmB,CAAC;AAC1B,EAAE,OAAO,GAAG;AACZ;AACA,EAAE,UAAU,GAAG;AACf,IAAI,UAAU,EAAE;AAChB;AACA,EAAE,OAAO,CAAC,UAAU,EAAE;AACtB,IAAI,OAAO,CAAC,UAAU,CAAC;AACvB;AACA,EAAE,mBAAmB,CAAC,UAAU,EAAE,QAAQ,EAAE;AAC5C,IAAI,mBAAmB,CAAC,UAAU,EAAE,QAAQ,CAAC;AAC7C;AACA,EAAE,uBAAuB,CAAC,UAAU,EAAE;AACtC,IAAI,uBAAuB,CAAC,UAAU,CAAC;AACvC;AACA,EAAE,uBAAuB,CAAC,UAAU,EAAE,QAAQ,EAAE;AAChD,IAAI,uBAAuB,CAAC,UAAU,EAAE,QAAQ,CAAC;AACjD;AACA,EAAE,2BAA2B,CAAC,UAAU,EAAE;AAC1C,IAAI,2BAA2B,CAAC,UAAU,CAAC;AAC3C;AACA,EAAE,iBAAiB,CAAC,IAAI,GAAG,SAAS,EAAE;AACtC,IAAI,iBAAiB,CAAC,IAAI,CAAC;AAC3B;AACA,EAAE,OAAO,CAAC,MAAM,EAAE;AAClB;AACA;AACA,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;AACnC,EAAE,SAAS,CAAC,SAAS,CAAC,CAAC,IAAI,KAAK;AAChC,IAAI,IAAI,IAAI,EAAE,EAAE,EAAE;AAClB,MAAM,mBAAmB,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE,CAAC;AACrD;AACA,GAAG,CAAC;AACJ;AACA,MAAM,mBAAmB,GAAG,IAAI,mBAAmB,EAAE;;;;"}